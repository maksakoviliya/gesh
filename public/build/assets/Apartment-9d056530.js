import{k as H,d as D,a as R,b as G,h as q,i as A,_ as O}from"./AppLayout-4291fc2f.js";import{o as n,i as d,F as V,k as P,n as W,g as t,c as $,e as B,u as p,a as Z,r as N,w as h,f as i,t as r,l as x,j as S}from"./app-d61f6bb3.js";import{_ as J}from"./Heading-78f5340d.js";import{_ as Y}from"./ButtonComponent-ead51c10.js";import{u as E}from"./useToasts-45c70187.js";import{_ as K}from"./Map.vue_vue_type_script_setup_true_lang-4ba26031.js";import"./index-d410e453.js";import"./_plugin-vue_export-helper-c27b6911.js";const Q={class:"rounded-xl grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 grid-rows-2 md:max-h-72 gap-1 overflow-hidden"},X=["src"],tt={__name:"Gallery",props:{images:{type:Array,default:[]}},setup(_){const e=_,g=f=>{let a=[];return f===0&&a.push("row-span-2",e.images.length===1?"col-span-full":"col-span-2"),a.join(" ")};return(f,a)=>(n(),d("div",Q,[(n(!0),d(V,null,P(_.images,(v,y)=>(n(),d("div",{class:W(["group overflow-hidden",g(y)])},[t("img",{src:v.src,class:"object-cover w-full h-full transition cursor-pointer group-hover:scale-110",alt:""},null,8,X)],2))),256))]))}};const et={__name:"Datepicker",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},disabledDates:{type:Array,default:()=>[]}},emits:["setDates","invalidSelect"],setup(_,{emit:e}){const g=_,f=$(()=>[g.start,g.end]),a=e,v=u=>{a("setDates",{start:u[0],end:u[1]})},{errorToast:y}=E(),b=u=>{a("invalidSelect",u),y("Выбранный диапазон дат недоступен.")};return(u,T)=>(n(),B(p(H),{"model-value":f.value,"onUpdate:modelValue":v,"no-disabled-range":"","multi-calendars":"",onInvalidSelect:b,"partial-range":!1,"auto-apply":"","month-change-on-scroll":!1,"min-range":"1","max-range":"30","disabled-dates":g.disabledDates,"disable-year-select":"","month-name-format":"long",locale:"ru",format:"dd.MM.yyyy",placeholder:"Выберите даты","min-date":new Date,"enable-time-picker":!1,"hide-navigation":["month","year","time"]},null,8,["model-value","disabled-dates","min-date"]))}},at={key:0,class:"text-3xl font-semibold"},st={class:"flex flex-col items-start lg:flex-row gap-6 justify-between mt-6 relative"},nt={class:"w-full lg:w-2/3"},lt=t("hr",{class:"my-4"},null,-1),rt={class:"flex justify-between gap-x-6"},ot={class:"flex min-w-0 gap-x-4"},dt={class:"min-w-0 flex-auto"},it={class:"text-sm font-semibold leading-6 text-gray-900"},ct={class:"mt-1 truncate text-xs leading-5 text-gray-500"},mt=t("div",{class:"hidden shrink-0 sm:flex sm:flex-col sm:items-end"},[t("p",{class:"text-sm leading-6 text-gray-900"},"Владелец"),t("p",{class:"mt-1 text-xs leading-5 text-gray-500"},[S(" На сайте "),t("time",{datetime:"2023-01-23T13:23Z"},"2 года")])],-1),ut=t("hr",{class:"my-4"},null,-1),_t={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},gt=["innerHTML"],pt={class:"text-sm text-neutral-500"},ft={key:1,class:"mt-4 py-4 border-t"},ht={key:2,class:"mt-4 py-4 border-t"},xt={class:"relative lg:sticky rounded-lg shadow-lg border border-neutral-100 w-full lg:w-1/3 lg:top-28 p-6"},vt={class:"flex flex-wrap gap-2 xl:gap-4"},yt={class:"text-2xl md:text-3xl font-semibold flex items-center gap-2"},bt=t("div",{class:"flex flex-col"},[t("span",{class:"text-neutral-500 font-light text-sm leading-none whitespace-nowrap"},"ночь в"),t("span",{class:"text-neutral-500 font-light text-sm leading-none"},"будни")],-1),wt={key:0,class:"text-2xl md:text-3xl font-semibold flex items-center gap-2"},kt=t("div",{class:"flex flex-col"},[t("span",{class:"text-neutral-500 font-light text-sm leading-none whitespace-nowrap"},"ночь в"),t("span",{class:"text-neutral-500 font-light text-sm leading-none"},"выходные")],-1),Dt={class:"mt-4"},$t={class:"flex flex-col gap-3 mt-4"},St=t("div",{class:"font-light text-sm text-center mt-3 text-neutral-500"},"Пока вы ни за что не платите",-1),jt={class:"divide-y divide-gray-100 border-t mt-4"},Vt={class:"py-4 flex flex-col gap-2"},Tt={class:"flex w-full items-baseline justify-between"},Lt={class:"font-light leading-6 text-gray-600"},Mt={class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},Pt={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},Bt={class:"font-light text-sm leading-6 text-gray-600"},Ct={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},qt={class:"mt-1 font-medium leading-6 text-neutral-600"},At={class:"flex w-full items-baseline justify-between"},Nt={class:"font-light leading-6"},Yt=t("div",{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"}," Сервисный сбор ",-1),Et=t("div",{class:"max-h-52 p-4 text-neutral-600 leading-tight text-sm"},[S(" Благодаря этому сбору мы развиваем наш сервис и, в том числе, обеспечиваем путешественников круглосуточной поддержкой. "),t("br"),S(" Данный сервисный сбор удерживатеся при отмене без уважительных причин. ")],-1),It={class:"mt-1 font-medium leading-6 text-neutral-600"},Ut={class:"border-t pt-4 flex flex-col gap-2"},zt={class:"flex w-full items-baseline justify-between"},Ft=t("dt",{class:"font-bold leading-6 text-neutral-800"}," Итого: ",-1),Ht={class:"mt-1 font-bold leading-6 text-lg text-neutral-800"},Xt={__name:"Apartment",props:{apartment:Array|Object},setup(_){var C;const e=_,g=()=>{var l;return[(l=e.apartment.data.category)==null?void 0:l.title,e.apartment.data.title??null,e.apartment.data.city].filter(c=>!!c).join(", ")},f=()=>[`${e.apartment.data.guests} гостей`,`${e.apartment.data.bedrooms} спальня`,`${e.apartment.data.beds} кровать`,`${e.apartment.data.bathrooms} ванная`].filter(l=>!!l).join(" · "),a=Z({start:new Date,end:new Date(new Date().setDate(new Date().getDate()+2)),range:2,guests:2,children:0}),v=$(()=>{let o=null;return(a.range<=1||a.range===21)&&(o=`${a.range} ночь`),(a.range>1&&a.range<=5||a.range>21&&a.range<=24)&&(o=`${a.range} ночи`),(a.range>5&&a.range<=20||a.range>24)&&(o=`${a.range} ночей`),`${o}`}),y=o=>{const l=D(o.start),c=D(o.end);a.start=l.set("hours",0).set("minutes",0).toDate(),a.end=c.set("hours",0).set("minutes",0).toDate(),a.range=c.diff(l,"day")},b=N([]),u=$(()=>{var w;const o=D(a.start),l=D(a.end);b.value=[];let c=0;for(let m=o;m.isBefore(l);m=m.add(1,"day")){const j=m.day()===5||m.day()===6?e.apartment.data.weekends_price:e.apartment.data.weekdays_price,k=((w=e.apartment.data.dates.find(s=>D(s.date).isSame(m)))==null?void 0:w.price)??j;b.value.push({date:m.format("DD.MM.YYYY"),price:k}),c+=k}return c}),T=$(()=>Math.ceil(u.value*.15)),I=$(()=>u.value+T.value),{errorToast:U}=E(),z=()=>a.post(route("reservation-requests.store",{apartment:e.apartment.data.id}),{onError:()=>{U("Error")}}),F=N([{center:[e.apartment.data.lat,e.apartment.data.lon],img:(C=e.apartment.data.media[0])==null?void 0:C.src}]);return(o,l)=>(n(),B(R,null,{default:h(()=>[i(O,null,{default:h(()=>{var c,w,m,j,L,k;return[e.apartment.data.address?(n(),d("div",at,r(e.apartment.data.address),1)):x("",!0),i(tt,{class:"mt-6",images:_.apartment.data.media},null,8,["images"]),t("div",st,[t("div",nt,[i(J,{title:g(),subtitle:f()},null,8,["title","subtitle"]),lt,t("div",rt,[t("div",ot,[i(G,{src:e.apartment.data.owner.avatar,class:"h-12 w-12 flex-none rounded-full bg-gray-50"},null,8,["src"]),t("div",dt,[t("p",it," Хозяин: "+r(e.apartment.data.owner.name),1),t("p",ct,r(e.apartment.data.owner.email),1)])]),mt]),e.apartment.data.features.length?(n(),d(V,{key:0},[ut,t("div",_t,[(n(!0),d(V,null,P(e.apartment.data.features,s=>(n(),d("div",{key:s.id,class:"flex items-center gap-3"},[t("div",{class:"text-neutral-800",innerHTML:s.icon},null,8,gt),t("div",pt,r(s.title),1)]))),128))])],64)):x("",!0),e.apartment.data.description?(n(),d("div",ft,r(e.apartment.data.description),1)):x("",!0),e.apartment.data.lon&&e.apartment.data.lat?(n(),d("div",ht,[i(K,{lon:e.apartment.data.lon,lat:e.apartment.data.lat,"is-input":!1,markers:F.value},null,8,["lon","lat","markers"])])):x("",!0)]),t("div",xt,[t("div",vt,[t("div",yt,[S(r((c=e.apartment.data.weekdays_price)==null?void 0:c.toLocaleString())+"₽ ",1),bt]),e.apartment.data.weekdays_price!==e.apartment.data.weekends_price?(n(),d("div",wt,[S(r((w=e.apartment.data.weekends_price)==null?void 0:w.toLocaleString())+"₽ ",1),kt])):x("",!0)]),t("div",Dt,[i(et,{range:"",start:p(a).start,end:p(a).end,"disabled-dates":(m=e.apartment.data.disabled_dates)==null?void 0:m.map(s=>s.date),onSetDates:y},null,8,["start","end","disabled-dates"]),i(q,{modelValue:p(a).guests,"onUpdate:modelValue":l[0]||(l[0]=s=>p(a).guests=s),class:"mt-4",title:"Гости",subtitle:"Укажите количество гостей"},null,8,["modelValue"]),i(q,{modelValue:p(a).children,"onUpdate:modelValue":l[1]||(l[1]=s=>p(a).children=s),class:"mt-4",title:"Дети",subtitle:"0-12 лет"},null,8,["modelValue"])]),t("div",$t,[e.apartment.data.fast_reserve?(n(),B(Y,{key:0,label:"Моментальное бронирование"})):x("",!0),i(Y,{outline:!0,onClick:z,label:"Продолжить"})]),St,t("dl",jt,[t("div",Vt,[t("div",Tt,[t("dt",Lt,[i(A,null,{toggle:h(()=>[t("div",Mt,r(v.value),1)]),content:h(()=>[t("dl",Pt,[(n(!0),d(V,null,P(b.value,s=>{var M;return n(),d("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:s.date},[t("dt",Bt,r(s.date),1),t("dd",Ct,r((M=s.price)==null?void 0:M.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",qt,r((j=u.value)==null?void 0:j.toLocaleString())+"₽ ",1)]),t("div",At,[t("dt",Nt,[i(A,null,{toggle:h(()=>[Yt]),content:h(()=>[Et]),_:1})]),t("dd",It,r((L=T.value)==null?void 0:L.toLocaleString())+"₽ ",1)])])]),t("div",Ut,[t("div",zt,[Ft,t("dd",Ht,r((k=I.value)==null?void 0:k.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{Xt as default};
