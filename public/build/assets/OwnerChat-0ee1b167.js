import{e as B,_ as L}from"./AppLayout-11f8adf2.js";import{_ as N}from"./Heading-49a5d682.js";import{_ as S}from"./Avatar-fc54699b.js";import{_ as z,a as y,b as D}from"./TextareaInput-ad395fb1.js";import{q as E,r as F,l as n,w as c,a as s,e as o,u as m,v as T,i as A,f as d,g as a,n as u,c as r,F as C,b as $,x as H,t as O,O as M}from"./app-b5308e02.js";import{_ as U}from"./EmptyState-910d961c.js";import{_ as G}from"./ButtonComponent-461f0820.js";import{_ as I}from"./Breadcrumbs-ba2674e7.js";import{d as J}from"./index-33f57259.js";import{c as K,g as P}from"./index.esm.min-1b27cd8b.js";import"./Input-535d973a.js";import"./index-9ef572b0.js";import"./index-112d99a0.js";import"./useToasts-417f24ae.js";const Q={class:"mt-4 flex flex-col items-start md:flex-row gap-4 md:justify-between relative md:min-h-0"},R={key:0,class:"absolute inset-x-0 top-0 bottom-32 overflow-auto flex flex-col items-start gap-1.5"},W={key:2,class:"absolute inset-x-0 bottom-0 flex items-start gap-3"},X=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})],-1),Y={class:"h-full overflow-auto min-h-[300px] md:min-h-0"},Z=["onClick"],ee={class:"flex items-center gap-2"},te={class:"flex flex-col"},se={class:"text-sm font-bold text-neutral-800 dark:text-white"},ae={key:0,class:"text-sm font-light text-neutral-500"},oe={key:0},be={__name:"OwnerChat",props:{chats:{type:Object},messages:{type:[Object,null]},chat:{type:[Object,null]},apartment:{type:Object}},setup(q){K(J);const t=q,V=i=>{M.visit(route("account.apartments.owner.chat",{chat:i.id,apartment:i.apartment.id}))},l=E({message:""}),_=()=>{l.post(route("account.chat.messages.store",{chat:t.chat.data.id}),{preserveScroll:!0,onSuccess:()=>l.reset("message")})},j=F([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"apartments",route:route("account.apartments.list"),label:"Мои объекты"},{id:"chat",route:route("account.apartments.list"),label:"Чаты"}]);return(i,p)=>(s(),n(B,null,{default:c(()=>[o(L,null,{default:c(()=>{var f,h,v;return[o(I,{routes:j.value,class:"hidden md:flex"},null,8,["routes"]),o(N,{class:"mt-3 md:mt-8",title:"Чат объекта"}),t.chat?(s(),n(m(T),{key:0,class:"inline-flex items-center gap-2 mt-4 dark:text-slate-200 opacity-70 hover:opacity-100 transition",href:i.route("account.apartments.chats",{apartment:(f=t.chat.data.apartment)==null?void 0:f.id})},{default:c(()=>[o(m(P),{name:"hi-solid-chevron-left"}),A(" Назад ")]),_:1},8,["href"])):d("",!0),a("div",Q,[a("div",{class:u(["w-full md:w-2/3 relative min-h-[60vh]",t.chat?"":"hidden md:block"])},[t.chat&&((v=(h=t.messages)==null?void 0:h.data)!=null&&v.length)?(s(),r("div",R,[(s(!0),r(C,null,$(t.messages.data,e=>(s(),n(H(e.reservation_request?y:D),{"is-owner":"",item:e.reservation_request?e.reservation_request:e,key:e.id},null,8,["item"]))),128))])):(s(),n(U,{key:1,title:t.chat?"Сообщений пока нет":"Выберите чат",subtitle:t.chat?"Напишите первым!":"И одобрите запрос на бронирование"},null,8,["title","subtitle"])),t.chat?(s(),r("div",W,[o(z,{modelValue:m(l).message,"onUpdate:modelValue":p[0]||(p[0]=e=>m(l).message=e),id:"message",label:"Сообщение",onOnEnter:_},null,8,["modelValue"]),o(G,{"auto-width":!0,onClick:_,class:"px-4",outline:!0,label:""},{icon:c(()=>[X]),_:1})])):d("",!0)],2),a("div",{class:u(["block divide-y divide-gray-100 w-full md:w-1/3 md:sticky md:top-24 rounded-xl overflow-hidden shadow-xl h-auto py-2 border border-gray-50",t.chat?"hidden md:block":""])},[a("div",Y,[(s(!0),r(C,null,$(t.chats.data,e=>{var g,x,b,k,w;return s(),r("div",{key:e.id,onClick:re=>V(e),class:u(["gap-2 px-4 py-2 cursor-pointer flex flex-col w-full hover:bg-gray-100 dark:hover:bg-slate-600 transition",((g=t.chat)==null?void 0:g.data.id)===e.id?"bg-gray-100 dark:bg-slate-700":""])},[a("div",ee,[o(S,{src:e.user.avatar},null,8,["src"]),a("div",te,[a("div",se,O(e.user.name),1),(x=e.last_message)!=null&&x.reservation_request?d("",!0):(s(),r("div",ae,O((b=e.last_message)==null?void 0:b.message),1))])]),(k=e.last_message)!=null&&k.reservation_request?(s(),r("div",oe,[o(y,{compact:"",item:(w=e.last_message)==null?void 0:w.reservation_request},null,8,["item"])])):d("",!0)],10,Z)}),128))])],2)])]}),_:1})]),_:1}))}};export{be as default};
