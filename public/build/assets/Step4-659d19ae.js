import b from"./Form-26f9c8df.js";import{_ as h}from"./Heading-53cf8888.js";import{r as m,i as x,j as g,o as _,d as w,b as u,a as d,u as i,T as y,c as L,w as k,O as M}from"./app-64b89698.js";import{j as U}from"./vue-yandex-maps.esm-cf9ef625.js";import{a as $}from"./index-85e44f8c.js";import{c as C,g as N}from"./ButtonComponent-1f1be449.js";import"./AppLayout-7d3395a2.js";import"./useToasts-2df30662.js";import"./Breadcrumbs-b014e632.js";const O={class:"h-50vh overflow-hidden rounded-xl relative shadow-lg"},B={class:"absolute bottom-1/2 left-1/2 -translate-x-1/2 text-sky-500"},j={__name:"Map",props:{lat:Number|null,lon:Number|null},emits:["updateLon","updateLat"],setup(r,{emit:o}){const e=r,s=o,l=m([e.lat??52.92596754124867,e.lon??87.98709856259356]),a=m(null),t=m(null),p=async()=>{if(!a.value)return;console.log("[props.lat, props.lon]",l.value),await U({apiKey:"4b6179ba-b733-4d2b-af35-b06f33fc0141",lang:"ru_RU",coordorder:"latlong",enterprise:!1,version:"2.1",debug:!0});const n=["zoomControl"];t.value=new globalThis.ymaps.Map(a.value,{center:l.value,zoom:11,controls:n}),t.value.events.add("boundschange",function(c){const v=c.get("newCenter");s("updateLat",v[0]),s("updateLon",v[1])})},f=()=>{var n;if(a.value){for(let c=0;a.value.children.length;c++)(n=a.value.children[0])==null||n.remove();t.value=null}};return x(async()=>{await p()}),g(()=>{f()}),C($),m(!1),(n,c)=>(_(),w("div",O,[u("div",{ref_key:"mapElement",ref:a,style:{height:"450px"}},null,512),u("div",B,[d(i(N),{name:"hi-location-marker",scale:"2.8"})])]))}},E={class:"mt-0 md:mt-32 max-w-2xl mx-auto w-full pb-32"},S={class:"mt-10"},q={__name:"Step4",props:{apartment:Array|Object},setup(r){const o=r,e=y({lon:o.apartment.data.lon,lat:o.apartment.data.lat}),s=()=>{e.transform(t=>({...t,step:4})).post(route("account.apartments.store",{apartment:o.apartment.data.id}))},l=t=>{e.lon=t},a=t=>{e.lat=t};return(t,p)=>(_(),L(b,{step:4,onOnNextStep:s,onOnPrevStep:p[0]||(p[0]=f=>i(M).visit(t.route("account.apartments.step",{apartment:r.apartment.data.id,step:3})))},{default:k(()=>[u("div",E,[d(h,{title:"Уточните адрес",subtitle:"Проверьте что указанный вами адрес верно отобразился на карте."}),u("div",S,[d(j,{lon:i(e).lon,lat:i(e).lat,onUpdateLon:l,onUpdateLat:a},null,8,["lon","lat"])])])]),_:1}))}};export{q as default};
