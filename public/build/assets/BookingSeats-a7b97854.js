import{Q as E,q as F,r as z,p as g,c as i,e as c,F as A,b as D,g as p,u as l,t as y,w as f,i as w,f as n,G as S,a as d,n as G,v as V}from"./app-5ded2bbf.js";import{_ as L}from"./Counter-22040632.js";import{_ as M}from"./ButtonComponent-985ee6c7.js";import{u as Q}from"./useToasts-5e4fc693.js";import"./index.esm.min-5cae61a4.js";import"./index-b814d10c.js";const U={class:"w-full"},H={class:"p-2 border dark:border-slate-600 rounded-2xl flex gap-2 overflow-x-auto no-scrollbar"},I=["onClick","disabled"],J={class:"flex items-center justify-between"},K={class:"text-neutral-900 text-2xl font-bold dark:text-neutral-200"},P={key:0,class:"absolute inset-0 bg-white dark:bg-slate-800 flex flex-col items-center justify-center dark:text-neutral-400"},R={key:1,class:"font-light text-sm text-right mt-3 text-neutral-500 dark:text-slate-400"},se={__name:"BookingSeats",props:{drive:{type:Object}},setup(j){var m,_,v,h,k,x;const o=j,b=E(),a=F({start_at:((_=(m=b.props)==null?void 0:m.query)==null?void 0:_.start_at)??Object.keys((h=(v=o.drive)==null?void 0:v.data)==null?void 0:h.dates)[4],seats_count:((x=(k=b.props)==null?void 0:k.query)==null?void 0:x.seats_count)??1}),T=z(!1),$=e=>{a.start_at=e},{successToast:C,errorToast:B}=Q(),N=()=>{var e;a.post(route("transfer.regular-ride.booking",{drive:(e=o.drive.data)==null?void 0:e.id}),{preserveScroll:!0,onSuccess:t=>{var r,s;(s=(r=t.props)==null?void 0:r.flash)!=null&&s.info&&C(t.props.flash.info)},onError:t=>{console.log("err",t),B(Object.values(t)[0])}})},O=g(()=>{var e,t;return((t=(e=o.drive)==null?void 0:e.data)==null?void 0:t.price)*((a==null?void 0:a.seats_count)??1)}),q=g(()=>{var t,r,s;let e=(r=(t=o.drive)==null?void 0:t.data)==null?void 0:r.passengers_limit;if(a.start_at){const u=(s=o.drive)==null?void 0:s.data.dates[a.start_at];e=u==null?void 0:u.available_seats}return`Осталось свободных мест: ${e}`});return(e,t)=>{var r;return d(),i("div",U,[c("div",H,[(d(!0),i(A,null,D(Object.keys((r=o.drive)==null?void 0:r.data.dates),s=>(d(),i("button",{key:s,onClick:S(u=>$(s),["prevent"]),disabled:T.value,class:G(["p-4 transition rounded-xl text-sm font-bold cursor-pointer disabled:opacity-40 disabled:pointer-events-none",l(a).start_at===s?"bg-sky-200 text-neutral-900 dark:bg-sky-800 dark:text-neutral-200":"bg-gray-200 text-neutral-800 hover:bg-sky-100 dark:bg-slate-700 dark:text-neutral-400 dark:hover:bg-sky-900 dark:hover:text-neutral-300"])},y(s.slice(0,5)),11,I))),128))]),c("form",{onSubmit:S(N,["prevent"]),class:"mt-4 border dark:border-slate-600 rounded-2xl p-4 relative overflow-hidden"},[p(L,{modelValue:l(a).seats_count,"onUpdate:modelValue":t[0]||(t[0]=s=>l(a).seats_count=s),title:"Количество мест",subtitle:q.value},null,8,["modelValue","subtitle"]),c("div",J,[c("h2",K,y(O.value)+" ₽",1),p(M,{disabled:!e.$page.props.user,"auto-width":"",class:"px-4 mt-5 self-center"},{default:f(()=>[n(" Забронировать ")]),_:1},8,["disabled"])]),l(a).start_at?w("",!0):(d(),i("div",P," Выберите желаемую дату поездки ")),e.$page.props.user?w("",!0):(d(),i("div",R,[n(" Забронировать трансфер могут только авторизованные пользователи, "),p(l(V),{href:e.route("login"),class:"hover:underline font-medium hover:text-neutral-200"},{default:f(()=>[n("войдите")]),_:1},8,["href"]),n(" или "),p(l(V),{href:e.route("register"),class:"hover:underline font-medium hover:text-neutral-200"},{default:f(()=>[n("зарегистрируйтесь")]),_:1},8,["href"]),n(". ")]))],32)])}}};export{se as default};
