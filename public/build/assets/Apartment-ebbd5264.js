import{l as F,d as k,a as H,b as R,h as C,j as q,_ as G}from"./AppLayout-5bf1c183.js";import{a as s,c as d,F as V,b as M,n as O,g as t,k as D,m as P,u as p,j as W,r as A,w as h,e as i,t as r,f as x,i as $}from"./app-6aaab680.js";import{a as Z}from"./Heading-c93977cc.js";import{_ as N}from"./ButtonComponent-4185c897.js";import{u as Y}from"./useToasts-1a5a230d.js";import{_ as J}from"./Map.vue_vue_type_script_setup_true_lang-f880a5c9.js";import"./index-075b6eaa.js";const K={class:"rounded-xl grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 grid-rows-2 md:max-h-72 gap-1 overflow-hidden"},Q=["src"],X={__name:"Gallery",props:{images:{type:Array,default:[]}},setup(_){const e=_,g=f=>{let a=[];return f===0&&a.push("row-span-2",e.images.length===1?"col-span-full":"col-span-2"),a.join(" ")};return(f,a)=>(s(),d("div",K,[(s(!0),d(V,null,M(_.images,(v,y)=>(s(),d("div",{class:O(["group overflow-hidden",g(y)])},[t("img",{src:v.src,class:"object-cover w-full h-full transition cursor-pointer group-hover:scale-110",alt:""},null,8,Q)],2))),256))]))}};const tt={__name:"Datepicker",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},disabledDates:{type:Array,default:()=>[]}},emits:["setDates","invalidSelect"],setup(_,{emit:e}){const g=_,f=D(()=>[g.start,g.end]),a=e,v=u=>{a("setDates",{start:u[0],end:u[1]})},{errorToast:y}=Y(),b=u=>{a("invalidSelect",u),y("Выбранный диапазон дат недоступен.")};return(u,T)=>(s(),P(p(F),{"model-value":f.value,"onUpdate:modelValue":v,"no-disabled-range":"","multi-calendars":"",onInvalidSelect:b,"partial-range":!1,"auto-apply":"","month-change-on-scroll":!1,"max-range":"30","disabled-dates":g.disabledDates,"disable-year-select":"","month-name-format":"long",locale:"ru",format:"dd.MM.yyyy",placeholder:"Выберите даты","min-date":new Date,"enable-time-picker":!1,"hide-navigation":["month","year","time"]},null,8,["model-value","disabled-dates","min-date"]))}},et={key:0,class:"text-3xl font-semibold"},at={class:"flex flex-col items-start lg:flex-row gap-6 justify-between mt-6 relative"},st={class:"w-full lg:w-2/3"},nt=t("hr",{class:"my-4"},null,-1),lt={class:"flex justify-between gap-x-6"},rt={class:"flex min-w-0 gap-x-4"},ot={class:"min-w-0 flex-auto"},dt={class:"text-sm font-semibold leading-6 text-gray-900"},it={class:"mt-1 truncate text-xs leading-5 text-gray-500"},ct=t("div",{class:"hidden shrink-0 sm:flex sm:flex-col sm:items-end"},[t("p",{class:"text-sm leading-6 text-gray-900"},"Владелец"),t("p",{class:"mt-1 text-xs leading-5 text-gray-500"},[$(" На сайте "),t("time",{datetime:"2023-01-23T13:23Z"},"2 года")])],-1),mt=t("hr",{class:"my-4"},null,-1),ut={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},_t=["innerHTML"],gt={class:"text-sm text-neutral-500"},pt={key:1,class:"mt-4 py-4 border-t"},ft={key:2,class:"mt-4 py-4 border-t"},ht={class:"relative lg:sticky rounded-lg shadow-lg border border-neutral-100 w-full lg:w-1/3 lg:top-28 p-6"},xt={class:"flex flex-wrap gap-2 xl:gap-4"},vt={class:"text-2xl md:text-3xl font-semibold flex items-center gap-2"},yt=t("div",{class:"flex flex-col"},[t("span",{class:"text-neutral-500 font-light text-sm leading-none whitespace-nowrap"},"ночь в"),t("span",{class:"text-neutral-500 font-light text-sm leading-none"},"будни")],-1),bt={key:0,class:"text-2xl md:text-3xl font-semibold flex items-center gap-2"},wt=t("div",{class:"flex flex-col"},[t("span",{class:"text-neutral-500 font-light text-sm leading-none whitespace-nowrap"},"ночь в"),t("span",{class:"text-neutral-500 font-light text-sm leading-none"},"выходные")],-1),kt={class:"mt-4"},Dt={class:"flex flex-col gap-3 mt-4"},$t=t("div",{class:"font-light text-sm text-center mt-3 text-neutral-500"},"Пока вы ни за что не платите",-1),St={class:"divide-y divide-gray-100 border-t mt-4"},jt={class:"py-4 flex flex-col gap-2"},Vt={class:"flex w-full items-baseline justify-between"},Tt={class:"font-light leading-6 text-gray-600"},Lt={class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},Mt={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},Pt={class:"font-light text-sm leading-6 text-gray-600"},Bt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},Ct={class:"mt-1 font-medium leading-6 text-neutral-600"},qt={class:"flex w-full items-baseline justify-between"},At={class:"font-light leading-6"},Nt=t("div",{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"}," Сервисный сбор ",-1),Yt=t("div",{class:"max-h-52 p-4 text-neutral-600 leading-tight text-sm"},[$(" Благодаря этому сбору мы развиваем наш сервис и, в том числе, обеспечиваем путешественников круглосуточной поддержкой. "),t("br"),$(" Данный сервисный сбор удерживатеся при отмене без уважительных причин. ")],-1),Et={class:"mt-1 font-medium leading-6 text-neutral-600"},It={class:"border-t pt-4 flex flex-col gap-2"},Ut={class:"flex w-full items-baseline justify-between"},zt=t("dt",{class:"font-bold leading-6 text-neutral-800"}," Итого: ",-1),Ft={class:"mt-1 font-bold leading-6 text-lg text-neutral-800"},Qt={__name:"Apartment",props:{apartment:Array|Object},setup(_){var B;const e=_,g=()=>{var n;return[(n=e.apartment.data.category)==null?void 0:n.title,e.apartment.data.title??null,e.apartment.data.city].filter(c=>!!c).join(", ")},f=()=>[`${e.apartment.data.guests} гостей`,`${e.apartment.data.bedrooms} спальня`,`${e.apartment.data.beds} кровать`,`${e.apartment.data.bathrooms} ванная`].filter(n=>!!n).join(" · "),a=W({start:new Date,end:new Date(new Date().setDate(new Date().getDate()+2)),range:2,guests:2,children:0}),v=D(()=>{let o=null;return(a.range<=1||a.range===21)&&(o=`${a.range} ночь`),(a.range>1&&a.range<=5||a.range>21&&a.range<=24)&&(o=`${a.range} ночи`),(a.range>5&&a.range<=20||a.range>24)&&(o=`${a.range} ночей`),`${o}`}),y=o=>{const n=k(o.start),c=k(o.end);a.start=n.set("hours",0).set("minutes",0).toDate(),a.end=c.set("hours",0).set("minutes",0).toDate(),a.range=c.diff(n,"day")},b=A([]),u=D(()=>{var w;const o=k(a.start),n=k(a.end);b.value=[];let c=0;for(let m=o;m.isBefore(n);m=m.add(1,"day")){const S=m.day()===5||m.day()===6?e.apartment.data.weekends_price:e.apartment.data.weekdays_price,l=((w=e.apartment.data.dates.find(j=>k(j.date).isSame(m)))==null?void 0:w.price)??S;b.value.push({date:m.format("DD.MM.YYYY"),price:l}),c+=l}return c}),T=D(()=>Math.ceil(u.value*.15)),E=D(()=>u.value+T.value),{errorToast:I}=Y(),U=()=>a.post(route("reservation-requests.store",{apartment:e.apartment.data.id}),{onError:()=>{I("Error")}}),z=A([{center:[e.apartment.data.lat,e.apartment.data.lon],img:(B=e.apartment.data.media[0])==null?void 0:B.src}]);return(o,n)=>(s(),P(H,null,{default:h(()=>[i(G,null,{default:h(()=>{var c,w,m,S,L;return[e.apartment.data.address?(s(),d("div",et,r(e.apartment.data.address),1)):x("",!0),i(X,{class:"mt-6",images:_.apartment.data.media},null,8,["images"]),t("div",at,[t("div",st,[i(Z,{title:g(),subtitle:f()},null,8,["title","subtitle"]),nt,t("div",lt,[t("div",rt,[i(R,{src:e.apartment.data.owner.avatar,class:"h-12 w-12 flex-none rounded-full bg-gray-50"},null,8,["src"]),t("div",ot,[t("p",dt," Хозяин: "+r(e.apartment.data.owner.name),1),t("p",it,r(e.apartment.data.owner.email),1)])]),ct]),e.apartment.data.features.length?(s(),d(V,{key:0},[mt,t("div",ut,[(s(!0),d(V,null,M(e.apartment.data.features,l=>(s(),d("div",{key:l.id,class:"flex items-center gap-3"},[t("div",{class:"text-neutral-800",innerHTML:l.icon},null,8,_t),t("div",gt,r(l.title),1)]))),128))])],64)):x("",!0),e.apartment.data.description?(s(),d("div",pt,r(e.apartment.data.description),1)):x("",!0),e.apartment.data.lon&&e.apartment.data.lat?(s(),d("div",ft,[i(J,{lon:e.apartment.data.lon,lat:e.apartment.data.lat,"is-input":!1,markers:z.value},null,8,["lon","lat","markers"])])):x("",!0)]),t("div",ht,[t("div",xt,[t("div",vt,[$(r((c=e.apartment.data.weekdays_price)==null?void 0:c.toLocaleString())+"₽ ",1),yt]),e.apartment.data.weekdays_price!==e.apartment.data.weekends_price?(s(),d("div",bt,[$(r((w=e.apartment.data.weekends_price)==null?void 0:w.toLocaleString())+"₽ ",1),wt])):x("",!0)]),t("div",kt,[i(tt,{range:"",start:p(a).start,end:p(a).end,"disabled-dates":e.apartment.data.all_disabled_dates??[],onSetDates:y},null,8,["start","end","disabled-dates"]),i(C,{modelValue:p(a).guests,"onUpdate:modelValue":n[0]||(n[0]=l=>p(a).guests=l),class:"mt-4",title:"Гости",subtitle:"Укажите количество гостей"},null,8,["modelValue"]),i(C,{modelValue:p(a).children,"onUpdate:modelValue":n[1]||(n[1]=l=>p(a).children=l),class:"mt-4",title:"Дети",subtitle:"0-12 лет"},null,8,["modelValue"])]),t("div",Dt,[e.apartment.data.fast_reserve?(s(),P(N,{key:0,label:"Моментальное бронирование"})):x("",!0),i(N,{outline:!0,onClick:U,label:"Продолжить"})]),$t,t("dl",St,[t("div",jt,[t("div",Vt,[t("dt",Tt,[i(q,null,{toggle:h(()=>[t("div",Lt,r(v.value),1)]),content:h(()=>[t("dl",Mt,[(s(!0),d(V,null,M(b.value,l=>{var j;return s(),d("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:l.date},[t("dt",Pt,r(l.date),1),t("dd",Bt,r((j=l.price)==null?void 0:j.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",Ct,r((m=u.value)==null?void 0:m.toLocaleString())+"₽ ",1)]),t("div",qt,[t("dt",At,[i(q,null,{toggle:h(()=>[Nt]),content:h(()=>[Yt]),_:1})]),t("dd",Et,r((S=T.value)==null?void 0:S.toLocaleString())+"₽ ",1)])])]),t("div",It,[t("div",Ut,[zt,t("dd",Ft,r((L=E.value)==null?void 0:L.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{Qt as default};
