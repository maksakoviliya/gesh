import{d as g,a as V,f as Y,_ as C}from"./AppLayout-cc888bee.js";import{_ as F}from"./Heading-8240a862.js";import{r as k,k as l,m as O,w as n,a as m,e as i,g as t,t as a,c as h,f as P,u as H,v as z,b as E,F as q,i as M,O as A}from"./app-c6e435d4.js";import{c as G}from"./customParseFormat-ac907730.js";import{_ as I}from"./ButtonComponent-84d7beee.js";import{_ as J}from"./Breadcrumbs-bd5acae2.js";import"./index.esm.min-1db1bd97.js";import"./index-3ed4b371.js";import"./Input-bacc8905.js";import"./Avatar-d702daea.js";import"./useToasts-a9fe3d4e.js";const K={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},Q={class:"md:w-1/2 lg:w-2/3"},R=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Ваша поездка:",-1),U={class:"mt-3"},W=t("div",{class:"text-sm font-medium"},"Даты:",-1),X={class:"font-light"},Z={class:"mt-3"},tt=t("div",{class:"text-sm font-medium"},"Гости:",-1),et={class:"font-light"},at={key:0,class:"font-light"},st=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Оплата:",-1),ot=t("div",{class:"font-light text-sm text-neutral-800 leading-tight mt-2"}," Сейчас вам необходимо оплатить только 30% от общей суммы, чтобы забронировать жилье. Оставшуюся сумму вы сможете перевести хозяину при заселении в жилье. Таким образом, вы можете забронировать жилье заранее и не переживать о полной оплате до момента заселения. Оплата оставшейся суммы при заселении гарантирует вам получение жилья и удобство в расчетах. ",-1),rt={class:"md:sticky w-full md:w-1/2 lg:w-1/3 rounded-lg shadow-lg border border-neutral-100 top-28 p-6"},nt={class:"flex items-stretch justify-start gap-4"},it=["src"],dt={class:"flex flex-col justify-between"},lt={class:"text-gray-600 font-light"},ct=["innerHTML"],ut=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Детализация цены:",-1),_t={class:"divide-y divide-gray-100"},mt={class:"py-2 flex w-full items-baseline justify-between"},vt=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Гости:")],-1),ft={class:"mt-1 font-medium leading-6 text-neutral-600"},gt={key:0,class:"py-2 flex w-full items-baseline justify-between"},ht=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Дети:")],-1),pt={class:"mt-1 font-medium leading-6 text-neutral-600"},xt={class:"py-4 flex flex-col gap-2"},bt={class:"flex w-full items-baseline justify-between"},yt={class:"font-light leading-6 text-gray-600"},wt={class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},$t={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},jt={class:"font-light text-sm leading-6 text-gray-600"},Yt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},kt={class:"mt-1 font-medium leading-6 text-neutral-600"},Pt={class:"flex w-full items-baseline justify-between"},Mt={class:"font-light leading-6"},Dt=t("div",{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"}," Сервисный сбор ",-1),Lt=t("div",{class:"max-h-52 p-4 text-neutral-600 leading-tight text-sm"},[M(" Благодаря этому сбору мы развиваем наш сервис и, в том числе, обеспечиваем путешественников круглосуточной поддержкой. "),t("br"),M(" Данный сервисный сбор удерживатеся при отмене без уважительных причин. ")],-1),St={class:"mt-1 font-medium leading-6 text-neutral-600"},Bt={class:"pt-4 flex w-full items-baseline justify-between"},Tt=t("dt",{class:"font-bold leading-6 text-neutral-00"},[t("div",null,"Итого:")],-1),Nt={class:"mt-1 font-bold leading-6 text-neutral-800"},Jt={__name:"Payment",props:{reservation:{type:Object}},setup(D){var $,j;const e=D,p=k([]),x=l(()=>{var u;g.extend(G);const o=g(e.reservation.data.start,"DD.MM.YYYY"),v=g(e.reservation.data.end,"DD.MM.YYYY");p.value=[];let c=0;for(let s=o;s.isBefore(v);s=s.add(1,"day")){const f=s.day()===5||s.day()===6?e.reservation.data.apartment.weekends_price:e.reservation.data.apartment.weekdays_price,_=((u=e.reservation.data.apartment.dates.find(r=>g(r.date).isSame(s)))==null?void 0:u.price)??f;p.value.push({date:s.format("DD.MM.YYYY"),price:_}),c+=_}return c}),L=l(()=>{let o=null;return(e.reservation.data.range<=1||e.reservation.data.range===21)&&(o=`${e.reservation.data.range} ночь`),(e.reservation.data.range>1&&e.reservation.data.range<=5||e.reservation.data.range>21&&e.reservation.data.range<=24)&&(o=`${e.reservation.data.range} ночи`),(e.reservation.data.range>5&&e.reservation.data.range<=20||e.reservation.data.range>24)&&(o=`${e.reservation.data.range} ночей`),`${o}`}),S=l(()=>[`${e.reservation.data.apartment.guests}&nbsp;гостей`,`${e.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${e.reservation.data.apartment.beds}&nbsp;кровать`,`${e.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(v=>!!v).join(" · ")),B=()=>{A.visit(route("account.reservations.pay",{reservation:e.reservation.data.id}))},T=k([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:($=e.reservation.data)==null?void 0:$.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(j=e.reservation.data)==null?void 0:j.id}),label:"Оплата"}]),y=l(()=>Math.ceil(x.value*.18)),w=l(()=>x.value+y.value),N=l(()=>Math.ceil(w.value*.3));return(o,v)=>(m(),O(V,null,{default:n(()=>[i(C,null,{default:n(()=>{var c,u,s,f,b,_;return[i(J,{routes:T.value},null,8,["routes"]),t("div",K,[t("div",Q,[i(F,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее суток, иначе бронирование отменится."}),t("div",null,[R,t("div",U,[W,t("div",X,a(e.reservation.data.start)+" - "+a(e.reservation.data.end),1)]),t("div",Z,[tt,t("div",et,a(e.reservation.data.guests)+" гостя",1),e.reservation.data.children?(m(),h("div",at,a(e.reservation.data.children)+" детей ",1)):P("",!0)])]),t("div",null,[st,i(I,{class:"mt-3 px-16","auto-width":!0,label:`Перейти к оплате: ${N.value.toLocaleString()}₽`,onClick:B},null,8,["label"]),ot])]),t("div",rt,[t("div",nt,[i(H(z),{href:o.route("apartment",{apartment:(c=e.reservation.data.apartment)==null?void 0:c.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:n(()=>{var r,d;return[t("img",{src:(d=(r=e.reservation.data.apartment)==null?void 0:r.media[0])==null?void 0:d.src,class:"h-full w-full object-cover",alt:""},null,8,it)]}),_:1},8,["href"]),t("div",dt,[t("div",lt,a((f=(s=(u=e.reservation.data)==null?void 0:u.apartment)==null?void 0:s.category)==null?void 0:f.title),1),t("div",{class:"font-light text-xs text-gray-600 mt-1",innerHTML:S.value},null,8,ct)])]),ut,t("dl",_t,[t("div",mt,[vt,t("dd",ft,a(e.reservation.data.guests),1)]),e.reservation.data.children>0?(m(),h("div",gt,[ht,t("dd",pt,a(e.reservation.data.children),1)])):P("",!0),t("div",xt,[t("div",bt,[t("dt",yt,[i(Y,null,{toggle:n(()=>[t("div",wt,a(L.value),1)]),content:n(()=>[t("dl",$t,[(m(!0),h(q,null,E(p.value,r=>{var d;return m(),h("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:r.date},[t("dt",jt,a(r.date),1),t("dd",Yt,a((d=r.price)==null?void 0:d.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",kt,a((b=x.value)==null?void 0:b.toLocaleString())+"₽ ",1)]),t("div",Pt,[t("dt",Mt,[i(Y,null,{toggle:n(()=>[Dt]),content:n(()=>[Lt]),_:1})]),t("dd",St,a((_=y.value)==null?void 0:_.toLocaleString())+"₽ ",1)])]),t("div",Bt,[Tt,t("dd",Nt,a(w.value.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{Jt as default};
