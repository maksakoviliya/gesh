import{_ as O}from"./ButtonComponent-2a6831d3.js";import{_ as z}from"./index-b1d9ea99.js";import{_ as F}from"./Input-90dd22c5.js";import{r as S,l as I,a as l,c as r,g as e,t as a,n as j,i as _,f as d,F as f,e as p,j as K,w as L,u as C,O as D,Y as G,G as U}from"./app-c4112bcf.js";import{u as Y}from"./useToasts-28aced63.js";import{_ as H}from"./Avatar-26e0f968.js";const J=e("div",{class:"font-semibold text-neutral-800 dark:text-slate-200"},"Запрос на бронирование",-1),P={class:"font-light text-xs text-gray-400"},Q={class:"font-light text-neutral-800 dark:text-white"},W={class:"text-neutral-400 text-sm"},X={class:"font-light text-neutral-800 dark:text-slate-200"},Z={key:0},tt={class:"flex items-center gap-2 flex-wrap"},et={class:"font-light text-neutral-800 dark:text-slate-200"},st=e("span",{class:"dark:text-slate-300"},"|",-1),at={class:"font-light text-neutral-800 dark:text-slate-200"},lt={key:0,class:"text-sm font-light text-right text-gray-500 dark:text-slate-400 mt-2"},ot={key:1,class:"text-sm font-light text-right text-gray-500 dark:text-slate-400 mt-2"},rt={key:2,class:"text-sm font-light text-right text-emerald-500 dark:text-teal-400 mt-2"},nt={key:0,class:"flex justify-end gap-2 mt-3"},it={id:"copy_payment_link",role:"tooltip",class:"absolute z-20 break-words whitespace-nowrap invisible inline-block px-3 py-2 text-xs font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700"},dt=e("div",{class:"tooltip-arrow","data-popper-arrow":""},null,-1),ut={key:4,class:"font-light text-neutral-800"},ct=e("div",{class:"text-neutral-400 text-sm mt-1"},"Если укажете - то гость будет видеть причину отказа.",-1),vt={class:"divide-y divide-gray-100"},mt={class:"py-2 flex w-full items-baseline justify-between"},xt=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Даты:")],-1),_t={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},pt={class:"text-neutral-400 text-sm"},ft={class:"py-2 flex w-full items-baseline justify-between"},gt=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Взрослые:")],-1),ht={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},yt={key:0,class:"py-2 flex w-full items-baseline justify-between"},bt=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Дети:")],-1),kt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},wt={class:"py-2 flex w-full items-baseline justify-between"},$t={class:"font-light leading-6 text-gray-600 dark:text-slate-300"},Ot={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},St={class:"py-2 flex w-full items-baseline justify-between"},jt=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Первоначальный платеж:")],-1),Ct={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Gt={__name:"ReservationRequest",props:{item:{required:!0},compact:{type:Boolean,default:!1},isOwner:{type:Boolean,default:!1}},setup(i){const o=i,t=S(o.item),m=S(!1),u=S(!1),v=I({status_text:""}),{infoToast:b,successToast:k,errorToast:w}=Y(),E=()=>{axios.post(route("account.reservation-requests.reject",{reservationRequest:t.value.id}),{status_text:v.status_text}).then(n=>{var s,c;m.value=!1,t.value.status=(s=n.data)==null?void 0:s.status,t.value.status_text=(c=n.data)==null?void 0:c.status_text,b("Отказано в запросе на бронирование.")}).catch(n=>{var s,c,g,h,y;((s=n.response)==null?void 0:s.status)===422&&(console.log("error.response?.data?.message",(g=(c=n.response)==null?void 0:c.data)==null?void 0:g.message),v.setError("status_text",((y=(h=n.response)==null?void 0:h.data)==null?void 0:y.message)??"Что-то пошло не так."))})},M=()=>{axios.post(route("account.reservation-requests.submit",{reservationRequest:t.value.id})).then(n=>{var s,c;u.value=!1,t.value.status=(s=n.data)==null?void 0:s.status,t.value.reservation_id=(c=n.data)==null?void 0:c.reservation_id,k("Создано новое бронирование. Ожидайте оплату.")}).catch(n=>{w("Что-то пошло не так.")})},N=()=>{var n,s;if((n=t.value.reservation)!=null&&n.id){const c=o.isOwner?"account.reservations.owner.view":"account.reservations.view";D.visit(route(c,{reservation:(s=t.value.reservation)==null?void 0:s.id}))}},$=S("Копировать ссылку на оплату"),A=()=>{var n;$.value="Скопировано",navigator.clipboard.writeText(route("account.reservations.pay",{reservation:(n=t.value.reservation)==null?void 0:n.id})).then(()=>{$.value="Скопировано",setTimeout(()=>{$.value="Копировать ссылку на оплату"},1500)})};return(n,s)=>{var c,g,h,y,T,V,q,B,R;return l(),r("div",{class:j(["border border-gray-300 dark:border-slate-700 rounded-lg p-3",[t.value.status==="rejected"?"opacity-40":"",t.value.status==="submitted"?"border-teal-600":""]])},[e("div",{class:j(["flex items-baseline justify-between",o.compact?"flex-col-reverse gap-0":"gap-4"])},[J,e("div",P,a(t.value.created_at),1)],2),e("div",Q,[_(" с "+a(t.value.start)+" по "+a(t.value.end)+" | ",1),e("span",W,"ночи: "+a(t.value.range),1)]),e("div",X,[_(" Взрослые: "+a(t.value.guests)+" ",1),t.value.children>0?(l(),r("span",Z," | Дети: "+a(t.value.children),1)):d("",!0)]),e("div",tt,[e("div",et," Цена: "+a(t.value.price.toLocaleString())+"₽ ",1),st,e("div",at," Первоначальный платеж: "+a((c=t.value.first_payment)==null?void 0:c.toLocaleString())+"₽ ",1)]),t.value.status==="pending"&&!o.isOwner&&!o.compact?(l(),r("div",lt," Ожидаем решение собственника ")):d("",!0),t.value.status==="submitted"&&!o.compact&&(!((g=t.value.reservation)!=null&&g.id)||((h=t.value.reservation)==null?void 0:h.status)!=="paid")?(l(),r("div",ot,[((y=t.value.reservation)==null?void 0:y.status)==="payment_waiting"?(l(),r(f,{key:0},[_(" Ожидаем одобрение платежа ")],64)):(l(),r(f,{key:1},[_(" Ожидаем оплату ")],64))])):d("",!0),t.value.status==="submitted"&&((T=t.value.reservation)!=null&&T.id)&&((V=t.value.reservation)==null?void 0:V.status)==="paid"?(l(),r("div",rt," Оплачен ")):d("",!0),o.compact?d("",!0):(l(),r(f,{key:3},[o.isOwner||t.value.status==="submitted"&&((q=t.value.reservation)!=null&&q.id)?(l(),r("div",nt,[o.isOwner?(l(),r(f,{key:0},[t.value.status==="pending"?(l(),r(f,{key:0},[p(O,{label:"Отказать",onClick:s[0]||(s[0]=x=>m.value=!0),small:!0,outline:!0,"auto-width":!0,class:"px-3"}),p(O,{label:"Подтвердить",onClick:s[1]||(s[1]=x=>u.value=!0),small:!0,"bg-class":"bg-green-50","text-class":"text-green-800","border-class":"border-green-800","auto-width":!0,class:"px-3"})],64)):d("",!0)],64)):d("",!0),t.value.status==="submitted"&&((B=t.value.reservation)!=null&&B.id)?(l(),r(f,{key:1},[o.isOwner&&((R=t.value.reservation)==null?void 0:R.status)!=="paid"?(l(),K(O,{key:0,label:"Ссылка на оплату",small:!0,outline:!0,"auto-width":!0,"data-tooltip-target":"copy_payment_link",onClick:A,class:"px-3"})):d("",!0),e("div",it,[_(a($.value)+" ",1),dt]),p(O,{label:"К бронированию",small:!0,outline:!0,"auto-width":!0,onClick:N,class:"px-3"})],64)):d("",!0)])):d("",!0)],64)),t.value.status==="rejected"?(l(),r("div",ut,a(`Отказано${t.value.status_text?": "+t.value.status_text:""}`),1)):d("",!0),p(z,{"is-open":m.value,onOnSecondaryAction:s[3]||(s[3]=x=>m.value=!1),onOnClose:s[4]||(s[4]=x=>m.value=!1),onOnSubmit:E,title:"Отказать в запросе на бронирование","action-label":"Отказать","secondary-action-label":"Отменить"},{body:L(()=>[p(F,{modelValue:C(v).status_text,"onUpdate:modelValue":s[2]||(s[2]=x=>C(v).status_text=x),id:"reason",name:"reason",error:C(v).errors.status_text,label:"Укажите причину отказа (можно не указывать)"},null,8,["modelValue","error"]),ct]),_:1},8,["is-open"]),p(z,{"is-open":u.value,onOnSecondaryAction:s[5]||(s[5]=x=>u.value=!1),onOnClose:s[6]||(s[6]=x=>u.value=!1),onOnSubmit:M,title:"Подтвердить запрос на бронирование","action-label":"Подтвердить","secondary-action-label":"Отменить"},{body:L(()=>[e("dl",vt,[e("div",mt,[xt,e("dd",_t,[_(" с "+a(t.value.start)+" по "+a(t.value.end)+" | ",1),e("span",pt,"ночи: "+a(t.value.range),1)])]),e("div",ft,[gt,e("dd",ht,a(t.value.guests),1)]),t.value.children>0?(l(),r("div",yt,[bt,e("dd",kt,a(t.value.children),1)])):d("",!0),e("div",wt,[e("dt",$t,[e("div",null,a(t.value.range)+" ночи:",1)]),e("dd",Ot,a(t.value.price.toLocaleString())+"₽ ",1)]),e("div",St,[jt,e("dd",Ct,a(t.value.first_payment.toLocaleString())+"₽ ",1)])])]),_:1},8,["is-open"])],2)}}},Tt={class:"flex items-start gap-2"},Vt={class:"flex flex-col"},qt={class:"text-sm font-bold dark:text-slate-200"},Bt={key:0,class:"text-neutral-600 dark:text-slate-500"},Rt={class:"font-light text-xs text-gray-400 dark:text-slate-500"},zt={class:"dark:text-slate-200"},Ut={__name:"Message",props:{item:{type:Object,required:!0}},setup(i){const o=i;return(t,m)=>{var u,v,b,k,w;return l(),r("div",Tt,[p(H,{src:(u=o.item.user)==null?void 0:u.avatar},null,8,["src"]),e("div",Vt,[e("div",qt,[((b=(v=t.$page.props.user)==null?void 0:v.data)==null?void 0:b.id)===((k=o.item.user)==null?void 0:k.id)?(l(),r("span",Bt,"Вы:")):d("",!0),_(" "+a((w=o.item.user)==null?void 0:w.name)+" ",1),e("span",Rt,a(o.item.created_at),1)]),e("div",zt,a(o.item.message),1)])])}}},Lt={class:"w-full relative",autocomplete:"off"},Et=["id","disabled","value"],Mt={key:0,class:"text-rose-500 text-sm font-light"},Yt={__name:"TextareaInput",props:{id:String,label:String,type:String|null,error:String|null,disabled:Boolean|null,required:Boolean|null,modelValue:String,textareaClass:String|null},emits:["onEnter","update:modelValue"],setup(i,{emit:o}){const t=o;return(m,u)=>(l(),r("form",Lt,[e("textarea",{id:i.id,disabled:i.disabled,placeholder:" ",value:i.modelValue,onInput:u[0]||(u[0]=v=>m.$emit("update:modelValue",v.target.value)),onKeydown:u[1]||(u[1]=G(U(v=>t("onEnter"),["prevent"]),["enter"])),autocomplete:"new-password",class:j(["peer w-full p-4 pt-6 font-light bg-white dark:bg-slate-800 border-2 dark:text-white rounded-md shadow-none outline-none transition disabled:opacity-70 focus:ring-0 resize-none pl-4 disabled:cursor-not-allowed",`
                    ${i.error?"border-rose-500":"border-neutral-300 dark:border-slate-700"}
                ${i.error?"focus:border-rose-500":"focus:border-black dark:border-slate-700"}
                ${i.textareaClass}
            `])},null,42,Et),e("label",{class:j(["absolute text-md duration-150 transform -translate-y-3 scale-75 top-5 left-4 z-10 origin-[0] peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4",i.error?"text-rose-500":"text-zinc-400"])},a(i.label),3),i.error?(l(),r("div",Mt,a(i.error),1)):d("",!0)]))}};export{Yt as _,Gt as a,Ut as b};
