import{c as F,b as P,f as A,_ as q}from"./AppLayout-54a21a6b.js";import{_ as R}from"./Heading-f01cfd0b.js";import{d as U,h as G,r as N,m as D,j as z,w as u,a as v,e as c,g as e,t as s,c as b,f as L,u as I,i as M,v as J,b as K,F as Q,O as W}from"./app-c7cb40ed.js";import{_ as X}from"./ButtonComponent-13f1b0a9.js";import{_ as Z}from"./Breadcrumbs-1d6af527.js";import"./index.esm.min-91ca6f02.js";import"./index-33f57259.js";import"./ru-fcad2892.js";import"./Input-58a83ac9.js";import"./index-9ef572b0.js";import"./Avatar-62fd5ac4.js";import"./index-67b13401.js";import"./useToasts-4fcb9c3d.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const k=1e3,w=60*k,S=60*w,j=24*S,C="abort",V="end",Y="progress",O="start",B="visibilitychange";var tt=U({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:a=>a>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:a=>a>=0},transform:{type:Function,default:a=>a}},emits:[C,V,Y,O],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/j)},hours(){return Math.floor(this.totalMilliseconds%j/S)},minutes(){return Math.floor(this.totalMilliseconds%S/w)},seconds(){return Math.floor(this.totalMilliseconds%w/k)},milliseconds(){return Math.floor(this.totalMilliseconds%k)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/S)},totalMinutes(){return Math.floor(this.totalMilliseconds/w)},totalSeconds(){return Math.floor(this.totalMilliseconds/k)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(B,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(B,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(O),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const a=Math.min(this.totalMilliseconds,this.interval);if(a>0){let t,r;const _=l=>{t||(t=l),r||(r=l);const g=l-t;g>=a||g+(l-r)/2>=a?this.progress():this.requestId=requestAnimationFrame(_),r=l};this.requestId=requestAnimationFrame(_)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){this.counting&&(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(Y,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){this.counting&&(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(C))},end(){this.counting&&(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(V))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return G(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const et={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},st={class:"md:w-1/2 lg:w-2/3"},at=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Ваша поездка: ",-1),it={class:"mt-3"},ot=e("div",{class:"text-sm font-medium dark:text-slate-400"},"Даты:",-1),nt={class:"dark:text-slate-200 font-medium"},rt={class:"mt-3"},lt=e("div",{class:"text-sm font-medium dark:text-slate-400"},"Гости:",-1),dt={class:"dark:text-slate-200 font-medium"},ct={key:0,class:"font-medium dark:text-slate-200"},ut=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Оплата: ",-1),ht={class:"flex items-baseline gap-5"},mt=e("div",{class:"font-light text-sm text-neutral-800 leading-tight mt-4 dark:text-slate-400"},[M(" Сейчас вам необходимо оплатить только 30% от общей суммы, чтобы забронировать жилье. Оставшуюся сумму вы сможете перевести хозяину при заселении. "),e("br"),M("Таким образом, вы можете забронировать жилье заранее и не переживать о полной оплате до момента заселения. "),e("br"),M(" Оплата оставшейся суммы при заселении гарантирует вам получение жилья и удобство в расчетах. ")],-1),ft={class:"md:sticky w-full md:w-1/2 lg:w-1/3 rounded-lg shadow-lg border border-neutral-100 top-28 p-6"},vt={class:"flex items-stretch justify-start gap-4"},_t=["src"],gt={class:"flex flex-col justify-between"},pt={class:"text-gray-600 font-light dark:text-slate-300"},xt=["innerHTML"],yt=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:border-slate-600 dark:text-slate-200"}," Детализация цены: ",-1),bt={class:"divide-y divide-gray-100 dark:divide-slate-600"},Mt={class:"py-2 flex w-full items-baseline justify-between"},kt=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Гости:")],-1),wt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},St={key:0,class:"py-2 flex w-full items-baseline justify-between"},Et=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Дети:")],-1),Dt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},$t={class:"py-4 flex flex-col gap-2"},Tt={class:"flex w-full items-baseline justify-between"},Nt={class:"font-light leading-6 text-gray-600"},Lt={class:"font-light leading-none text-gray-600 dark:text-slate-300 outline-none border-b border-gray-400 dark:border-slate-300 hover:border-gray-600 transition"},It={class:"divide-y divide-gray-100 dark:divide-slate-600 max-h-52 overflow-auto"},jt={class:"font-light text-sm leading-6 text-gray-600 dark:text-slate-300"},Ct={class:"mt-1 text-sm font-medium leading-6 text-neutral-600 dark:text-slate-200"},Vt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Yt={class:"pt-4 flex w-full items-baseline justify-between"},Ot=e("dt",{class:"font-bold leading-6 text-neutral-800 dark:text-slate-200"},[e("div",null,"Итого:")],-1),Bt={class:"mt-1 font-bold leading-6 text-neutral-800 dark:text-slate-200"},Xt={__name:"Payment",props:{reservation:{type:Object}},setup(a){var $,T;const t=a,r=N([]);D(()=>{var m;dayjs.extend(F);const o=dayjs(t.reservation.data.start,"DD.MM.YYYY"),p=dayjs(t.reservation.data.end,"DD.MM.YYYY");r.value=[];let h=0;for(let i=o;i.isBefore(p);i=i.add(1,"day")){const x=i.day()===5||i.day()===6?t.reservation.data.apartment.weekends_price:t.reservation.data.apartment.weekdays_price,f=((m=t.reservation.data.apartment.dates.find(y=>dayjs(y.date).isSame(i)))==null?void 0:m.price)??x;r.value.push({date:i.format("DD.MM.YYYY"),price:f}),h+=f}return h});const _=D(()=>{let o=null;return(t.reservation.data.range<=1||t.reservation.data.range===21)&&(o=`${t.reservation.data.range} ночь`),(t.reservation.data.range>1&&t.reservation.data.range<=5||t.reservation.data.range>21&&t.reservation.data.range<=24)&&(o=`${t.reservation.data.range} ночи`),(t.reservation.data.range>5&&t.reservation.data.range<=20||t.reservation.data.range>24)&&(o=`${t.reservation.data.range} ночей`),`${o}`}),l=D(()=>[`${t.reservation.data.apartment.guests}&nbsp;гостей`,`${t.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${t.reservation.data.apartment.beds}&nbsp;кровать`,`${t.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(p=>!!p).join(" · ")),g=()=>{W.visit(route("account.reservations.pay",{reservation:t.reservation.data.id}))},H=N([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:($=t.reservation.data)==null?void 0:$.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(T=t.reservation.data)==null?void 0:T.id}),label:"Оплата"}]);return(o,p)=>(v(),z(P,null,{default:u(()=>[c(q,null,{default:u(()=>{var h,m,i,x,E,f,y;return[c(Z,{routes:H.value},null,8,["routes"]),e("div",et,[e("div",st,[c(R,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее чем через пять часов, иначе бронирование отменится."}),e("div",null,[at,e("div",it,[ot,e("div",nt,s(t.reservation.data.start)+" - "+s(t.reservation.data.end),1)]),e("div",rt,[lt,e("div",dt,s(t.reservation.data.guests)+" гостя",1),t.reservation.data.children?(v(),b("div",ct,s(t.reservation.data.children)+" детей ",1)):L("",!0)])]),e("div",null,[ut,e("div",ht,[c(X,{class:"mt-3 px-16","auto-width":!0,label:`Перейти к оплате: ${(h=t.reservation.data.first_payment)==null?void 0:h.toLocaleString()}₽`,onClick:g},null,8,["label"]),c(I(tt),{class:"text-neutral-800 dark:text-slate-400 font-medium text-lg",time:t.reservation.data.remaining},{default:u(({hours:n,minutes:d})=>[M(" Осталось "+s(n)+" ч. "+s(d)+" мин. ",1)]),_:1},8,["time"])]),mt])]),e("div",ft,[e("div",vt,[c(I(J),{href:o.route("apartment",{apartment:(m=t.reservation.data.apartment)==null?void 0:m.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:u(()=>{var n,d;return[e("img",{src:(d=(n=t.reservation.data.apartment)==null?void 0:n.media[0])==null?void 0:d.src,class:"h-full w-full object-cover",alt:""},null,8,_t)]}),_:1},8,["href"]),e("div",gt,[e("div",pt,s((E=(x=(i=t.reservation.data)==null?void 0:i.apartment)==null?void 0:x.category)==null?void 0:E.title),1),e("div",{class:"font-light text-xs text-gray-600 mt-1 dark:text-slate-300",innerHTML:l.value},null,8,xt)])]),yt,e("dl",bt,[e("div",Mt,[kt,e("dd",wt,s(t.reservation.data.guests),1)]),t.reservation.data.children>0?(v(),b("div",St,[Et,e("dd",Dt,s(t.reservation.data.children),1)])):L("",!0),e("div",$t,[e("div",Tt,[e("dt",Nt,[c(A,null,{toggle:u(()=>[e("div",Lt,s(_.value),1)]),content:u(()=>[e("dl",It,[(v(!0),b(Q,null,K(r.value,n=>{var d;return v(),b("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:n.date},[e("dt",jt,s(n.date),1),e("dd",Ct,s((d=n.price)==null?void 0:d.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),e("dd",Vt,s((f=t.reservation.data.price)==null?void 0:f.toLocaleString())+"₽ ",1)])]),e("div",Yt,[Ot,e("dd",Bt,s((y=t.reservation.data.price)==null?void 0:y.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{Xt as default};
