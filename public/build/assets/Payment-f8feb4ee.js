import{r as w,b as y,f as B,w as d,o as u,g as i,i as t,t as a,j as _,m as j,u as f,B as L,k as T,q as S,l as N,F as V,O as z}from"./app-64581b18.js";import{a as C,_ as F}from"./AppLayout-7963a932.js";import{_ as O}from"./Heading-9aeecd00.js";import{d as g}from"./dayjs.min-c8cd46d3.js";import{c as H}from"./customParseFormat-62c60dc0.js";import{_ as W}from"./ButtonComponent-905e81ae.js";import{_ as q}from"./Breadcrumbs-0c6fe5c9.js";import{y as E,j as A,W as G}from"./popover-939b1078.js";import"./index-d410e453.js";import"./useToasts-008ad7c5.js";import"./hidden-6df19931.js";const I={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},J={class:"md:w-1/2 lg:w-2/3"},K=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Ваша поездка:",-1),Q={class:"mt-3"},R=t("div",{class:"text-sm font-medium"},"Даты:",-1),U={class:"font-light"},X={class:"mt-3"},Z=t("div",{class:"text-sm font-medium"},"Гости:",-1),tt={class:"font-light"},et={key:0,class:"font-light"},at=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Оплата:",-1),st={class:"md:sticky w-full md:w-1/2 lg:w-1/3 rounded-lg shadow-lg border border-neutral-100 top-28 p-6"},rt={class:"flex items-stretch justify-start gap-4"},ot=["src"],it={class:"flex flex-col justify-between"},nt={class:"text-gray-600 font-light"},dt=["innerHTML"],lt=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Детализация цены:",-1),ct={class:"divide-y divide-gray-100"},ut={class:"py-4 flex w-full items-baseline justify-between"},mt={class:"font-light leading-6 text-пкфн-600"},vt={class:"overflow-hidden h-full rounded-lg shadow-lg ring-1 ring-black/5"},_t={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},ft={class:"font-light text-sm leading-6 text-gray-600"},gt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},ht={class:"mt-1 font-medium leading-6 text-neutral-600"},pt={class:"py-2 flex w-full items-baseline justify-between"},yt=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Гости:")],-1),xt={class:"mt-1 font-medium leading-6 text-neutral-600"},bt={key:0,class:"py-2 flex w-full items-baseline justify-between"},wt=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Дети:")],-1),jt={class:"mt-1 font-medium leading-6 text-neutral-600"},$t={class:"py-2 flex w-full items-baseline justify-between"},kt=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Стоимость:")],-1),Yt={class:"mt-1 font-medium leading-6 text-neutral-600"},Ot={__name:"Payment",props:{reservation:{type:Object}},setup($){var x,b;const e=$,h=w([]),k=y(()=>{var c;g.extend(H);const r=g(e.reservation.data.start,"DD.MM.YYYY"),m=g(e.reservation.data.end,"DD.MM.YYYY");h.value=[];let l=0;for(let s=r;s.isBefore(m);s=s.add(1,"day")){const v=s.day()===5||s.day()===6?e.reservation.data.apartment.weekends_price:e.reservation.data.apartment.weekdays_price,o=((c=e.reservation.data.apartment.dates.find(n=>g(n.date).isSame(s)))==null?void 0:c.price)??v;h.value.push({date:s.format("DD.MM.YYYY"),price:o}),l+=o}return l}),Y=y(()=>{let r=null;return(e.reservation.data.range<=1||e.reservation.data.range===21)&&(r=`${e.reservation.data.range} ночь`),(e.reservation.data.range>1&&e.reservation.data.range<=5||e.reservation.data.range>21&&e.reservation.data.range<=24)&&(r=`${e.reservation.data.range} ночи`),(e.reservation.data.range>5&&e.reservation.data.range<=20||e.reservation.data.range>24)&&(r=`${e.reservation.data.range} ночей`),`${r}`}),D=y(()=>[`${e.reservation.data.apartment.guests}&nbsp;гостей`,`${e.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${e.reservation.data.apartment.beds}&nbsp;кровать`,`${e.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(m=>!!m).join(" · ")),M=()=>{z.visit(route("account.reservations.pay",{reservation:e.reservation.data.id}))},P=w([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:(x=e.reservation.data)==null?void 0:x.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(b=e.reservation.data)==null?void 0:b.id}),label:"Оплата"}]);return(r,m)=>(u(),B(C,null,{default:d(()=>[i(F,null,{default:d(()=>{var l,c,s,v,p;return[i(q,{routes:P.value},null,8,["routes"]),t("div",I,[t("div",J,[i(O,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее суток, иначе бронирование отменится."}),t("div",null,[K,t("div",Q,[R,t("div",U,a(e.reservation.data.start)+" - "+a(e.reservation.data.end),1)]),t("div",X,[Z,t("div",tt,a(e.reservation.data.guests)+" гостя",1),e.reservation.data.children?(u(),_("div",et,a(e.reservation.data.children)+" детей ",1)):j("",!0)])]),t("div",null,[at,i(W,{class:"mt-3 px-16","auto-width":!0,label:"Перейти к оплате",onClick:M})])]),t("div",st,[t("div",rt,[i(f(L),{href:r.route("apartment",{apartment:(l=e.reservation.data.apartment)==null?void 0:l.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:d(()=>{var o,n;return[t("img",{src:(n=(o=e.reservation.data.apartment)==null?void 0:o.media[0])==null?void 0:n.src,class:"h-full w-full object-cover",alt:""},null,8,ot)]}),_:1},8,["href"]),t("div",it,[t("div",nt,a((v=(s=(c=e.reservation.data)==null?void 0:c.apartment)==null?void 0:s.category)==null?void 0:v.title),1),t("div",{class:"font-light text-xs text-gray-600 mt-1",innerHTML:D.value},null,8,dt)])]),lt,t("dl",ct,[t("div",ut,[t("dt",mt,[i(f(E),{class:"relative"},{default:d(()=>[i(f(A),{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},{default:d(()=>[T(a(Y.value),1)]),_:1}),i(S,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:d(()=>[i(f(G),{class:"absolute left-1/2 z-10 mt-3 w-screen max-w-xs z-10 bg-white -translate-x-1/2 transform px-4 sm:px-0"},{default:d(()=>[t("div",vt,[t("dl",_t,[(u(!0),_(V,null,N(h.value,o=>{var n;return u(),_("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:o.date},[t("dt",ft,a(o.date),1),t("dd",gt,a((n=o.price)==null?void 0:n.toLocaleString())+"₽ ",1)])}),128))])])]),_:1})]),_:1})]),_:1})]),t("dd",ht,a((p=k.value)==null?void 0:p.toLocaleString())+"₽ ",1)]),t("div",pt,[yt,t("dd",xt,a(e.reservation.data.guests),1)]),e.reservation.data.children>0?(u(),_("div",bt,[wt,t("dd",jt,a(e.reservation.data.children),1)])):j("",!0),t("div",$t,[kt,t("dd",Yt,a(e.reservation.data.price.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{Ot as default};
