import{d as m,c as I,e as q,f as R,_ as U}from"./AppLayout-9d3c37fb.js";import{_ as G}from"./Heading-fc2e8991.js";import{d as z,h as J,r as L,p as k,l as K,w as l,a as p,g as d,e as t,t as s,c as w,i as Y,u as C,f as c,v as Q,b as W,F as X,O as Z}from"./app-d0903334.js";import{_ as tt}from"./ButtonComponent-ecdc6171.js";import{_ as et}from"./Breadcrumbs-78fc7e6b.js";import{S as st}from"./SmallInfoBlock-6ed7ea18.js";import"./index.esm.min-56420626.js";import"./Counter-9c0adc6f.js";import"./index-b814d10c.js";import"./Input-b1adc0c3.js";import"./index-9ef572b0.js";import"./Avatar-add15d9f.js";import"./index-eca165c0.js";import"./useToasts-8e9df16f.js";import"./_plugin-vue_export-helper-c27b6911.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const S=1e3,E=60*S,D=60*E,V=24*D,j="abort",O="end",B="progress",H="start",A="visibilitychange";var at=z({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:i=>i>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:i=>i>=0},transform:{type:Function,default:i=>i}},emits:[j,O,B,H],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/V)},hours(){return Math.floor(this.totalMilliseconds%V/D)},minutes(){return Math.floor(this.totalMilliseconds%D/E)},seconds(){return Math.floor(this.totalMilliseconds%E/S)},milliseconds(){return Math.floor(this.totalMilliseconds%S)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/D)},totalMinutes(){return Math.floor(this.totalMilliseconds/E)},totalSeconds(){return Math.floor(this.totalMilliseconds/S)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(A,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(A,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(H),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const i=Math.min(this.totalMilliseconds,this.interval);if(i>0){let e,n;const g=u=>{e||(e=u),n||(n=u);const x=u-e;x>=i||x+(u-n)/2>=i?this.progress():this.requestId=requestAnimationFrame(g),n=u};this.requestId=requestAnimationFrame(g)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){this.counting&&(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(B,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){this.counting&&(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(j))},end(){this.counting&&(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(O))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return J(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const it={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},ot={class:"md:w-1/2 lg:w-2/3"},rt=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Ваша поездка: ",-1),nt={class:"mt-3"},lt=t("div",{class:"text-sm font-medium dark:text-slate-400"},"Даты:",-1),dt={class:"dark:text-slate-200 font-medium"},ct={class:"mt-3"},ut=t("div",{class:"text-sm font-medium dark:text-slate-400"},"Гости:",-1),ht={class:"dark:text-slate-200 font-medium"},mt={key:0,class:"font-medium dark:text-slate-200"},ft=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Оплата: ",-1),vt={class:"flex items-baseline gap-5"},_t=t("div",{class:"font-light text-sm text-neutral-800 leading-tight mt-4 dark:text-slate-400"},[c(" Сейчас вам необходимо оплатить только 30% от общей суммы, чтобы забронировать жилье. Оставшуюся сумму вы сможете перевести хозяину при заселении. "),t("br"),c("Таким образом, вы можете забронировать жилье заранее и не переживать о полной оплате до момента заселения. "),t("br"),c(" Оплата оставшейся суммы при заселении гарантирует вам получение жилья и удобство в расчетах. ")],-1),pt={class:"md:sticky w-full md:w-1/2 lg:w-1/3 top-14"},gt={class:"rounded-lg shadow-lg mt-6 border border-neutral-100 dark:border-slate-600 p-6"},xt={class:"flex items-stretch justify-start gap-4"},yt=["src"],bt={class:"flex flex-col justify-between"},Mt={class:"text-gray-600 font-light dark:text-slate-300"},kt=["innerHTML"],wt=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:border-slate-600 dark:text-slate-200"}," Детализация цены: ",-1),St={class:"divide-y divide-gray-100 dark:divide-slate-600"},Et={class:"py-2 flex w-full items-baseline justify-between"},Dt=t("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[t("div",null,"Гости:")],-1),$t={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Tt={key:0,class:"py-2 flex w-full items-baseline justify-between"},Nt=t("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[t("div",null,"Дети:")],-1),It={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Lt={class:"py-4 flex flex-col gap-2"},Yt={class:"flex w-full items-baseline justify-between"},Ct={class:"font-light leading-6 text-gray-600"},Vt={class:"font-light leading-none text-gray-600 dark:text-slate-300 outline-none border-b border-gray-400 dark:border-slate-300 hover:border-gray-600 transition"},jt={class:"divide-y divide-gray-100 dark:divide-slate-600 max-h-52 overflow-auto"},Ot={class:"font-light text-sm leading-6 text-gray-600 dark:text-slate-300"},Bt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600 dark:text-slate-200"},Ht={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},At={class:"pt-4 flex w-full items-baseline justify-between"},Ft=t("dt",{class:"font-bold leading-6 text-neutral-800 dark:text-slate-200"},[t("div",null,"Итого:")],-1),Pt={class:"mt-1 font-bold leading-6 text-neutral-800 dark:text-slate-200"},qt={class:"text-sm leading-normal text-gray-600 dark:text-slate-400 mt-2"},Rt=["href"],re={__name:"Payment",props:{reservation:{type:Object}},setup(i){var T,N;const e=i,n=L([]);k(()=>{var v;m.extend(I);const a=m(e.reservation.data.start,"DD.MM.YYYY"),y=m(e.reservation.data.end,"DD.MM.YYYY");n.value=[];let f=0;for(let o=a;o.isBefore(y);o=o.add(1,"day")){const b=o.day()===5||o.day()===6?e.reservation.data.apartment.weekends_price:e.reservation.data.apartment.weekdays_price,_=((v=e.reservation.data.apartment.dates.find(M=>m(M.date).isSame(o)))==null?void 0:v.price)??b;n.value.push({date:o.format("DD.MM.YYYY"),price:_}),f+=_}return f});const g=k(()=>{let a=null;return(e.reservation.data.range<=1||e.reservation.data.range===21)&&(a=`${e.reservation.data.range} ночь`),(e.reservation.data.range>1&&e.reservation.data.range<=5||e.reservation.data.range>21&&e.reservation.data.range<=24)&&(a=`${e.reservation.data.range} ночи`),(e.reservation.data.range>5&&e.reservation.data.range<=20||e.reservation.data.range>24)&&(a=`${e.reservation.data.range} ночей`),`${a}`}),u=k(()=>[`${e.reservation.data.apartment.guests}&nbsp;гостей`,`${e.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${e.reservation.data.apartment.beds}&nbsp;кровать`,`${e.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(y=>!!y).join(" · ")),x=()=>{Z.visit(route("account.reservations.pay",{reservation:e.reservation.data.id}))},F=L([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:(T=e.reservation.data)==null?void 0:T.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(N=e.reservation.data)==null?void 0:N.id}),label:"Оплата"}]),P=k(()=>{m.extend(I);const a=m(e.reservation.data.start,"DD.MM.YYYY").subtract(14,"days").hour(0);return m().isAfter(a)?"Отмена бронирования недоступна.":`Бесплатно до ${a.format("D MMMM")}. После - предоплату получит арендодатель.`});return(a,y)=>(p(),K(q,null,{default:l(()=>[d(U,null,{default:l(()=>{var f,v,o,b,$,_,M;return[d(et,{routes:F.value},null,8,["routes"]),t("div",it,[t("div",ot,[d(G,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее чем через пять часов, иначе бронирование отменится."}),t("div",null,[rt,t("div",nt,[lt,t("div",dt,s(e.reservation.data.start)+" - "+s(e.reservation.data.end),1)]),t("div",ct,[ut,t("div",ht,s(e.reservation.data.guests)+" гостя",1),e.reservation.data.children?(p(),w("div",mt,s(e.reservation.data.children)+" детей ",1)):Y("",!0)])]),t("div",null,[ft,t("div",vt,[d(tt,{class:"mt-3 px-16","auto-width":!0,label:`Перейти к оплате: ${(f=e.reservation.data.first_payment)==null?void 0:f.toLocaleString()}₽`,onClick:x},null,8,["label"]),d(C(at),{class:"text-neutral-800 dark:text-slate-400 font-medium text-lg",time:e.reservation.data.remaining},{default:l(({hours:r,minutes:h})=>[c(" Осталось "+s(r)+" ч. "+s(h)+" мин. ",1)]),_:1},8,["time"])]),_t])]),t("div",pt,[t("div",gt,[t("div",xt,[d(C(Q),{href:a.route("apartment",{apartment:(v=e.reservation.data.apartment)==null?void 0:v.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:l(()=>{var r,h;return[t("img",{src:(h=(r=e.reservation.data.apartment)==null?void 0:r.media[0])==null?void 0:h.src,class:"h-full w-full object-cover",alt:""},null,8,yt)]}),_:1},8,["href"]),t("div",bt,[t("div",Mt,s(($=(b=(o=e.reservation.data)==null?void 0:o.apartment)==null?void 0:b.category)==null?void 0:$.title),1),t("div",{class:"font-light text-xs text-gray-600 mt-1 dark:text-slate-300",innerHTML:u.value},null,8,kt)])]),wt,t("dl",St,[t("div",Et,[Dt,t("dd",$t,s(e.reservation.data.guests),1)]),e.reservation.data.children>0?(p(),w("div",Tt,[Nt,t("dd",It,s(e.reservation.data.children),1)])):Y("",!0),t("div",Lt,[t("div",Yt,[t("dt",Ct,[d(R,null,{toggle:l(()=>[t("div",Vt,s(g.value),1)]),content:l(()=>[t("dl",jt,[(p(!0),w(X,null,W(n.value,r=>{var h;return p(),w("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:r.date},[t("dt",Ot,s(r.date),1),t("dd",Bt,s((h=r.price)==null?void 0:h.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",Ht,s((_=e.reservation.data.price)==null?void 0:_.toLocaleString())+"₽ ",1)])]),t("div",At,[Ft,t("dd",Pt,s((M=e.reservation.data.price)==null?void 0:M.toLocaleString())+"₽ ",1)])])]),d(st,{class:"mt-4"},{title:l(()=>[c("Отмена брони:")]),content:l(()=>[c(s(P.value),1)]),_:1}),t("p",qt,[c(" При переходе к оплате вы соглашаетесь на "),t("a",{class:"underline hover:text-gray-500 dark:hover:text-slate-300",href:a.route("policy")},"обработку персональных данных",8,Rt),c(" и передачу персональных данных арендодателю ")])])])]}),_:1})]),_:1}))}};export{re as default};
