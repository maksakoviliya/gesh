import{e as q,_ as V}from"./AppLayout-5ed75d93.js";import{_ as B}from"./Heading-2a3ae3b5.js";import{_ as L}from"./Avatar-dcbd8743.js";import{_ as N,a as b,b as S}from"./TextareaInput-25a37c0e.js";import{p as z,r as D,l as n,w as c,a as t,e as o,g as a,c as r,F as w,b as k,u as y,f as m,v as E,n as F,t as $,O as A}from"./app-721bfe1b.js";import{_ as M}from"./EmptyState-f79cb27a.js";import{_ as T}from"./ButtonComponent-e18241c5.js";import{_ as U}from"./Breadcrumbs-d5cdfcc5.js";import"./index.esm.min-01e1520b.js";import"./index-4c8f8940.js";import"./Input-725ab7bc.js";import"./index-9ef572b0.js";import"./index-f4c16543.js";import"./useToasts-de922be9.js";const G={class:"mt-6 flex flex-col items-start md:flex-row gap-4 md:justify-between relative md:min-h-0 min-h-[600px] h-[70vh]"},H={class:"w-full md:w-2/3 h-full relative"},I={key:0,class:"absolute inset-x-0 top-0 bottom-32 overflow-auto flex flex-col items-start gap-1.5"},J={key:2,class:"absolute inset-x-0 bottom-0 flex items-start gap-3"},K=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})],-1),P={class:"block divide-y divide-gray-100 w-full md:w-1/3 md:sticky md:top-24 rounded-xl overflow-hidden shadow-xl h-auto py-2 border border-gray-50"},Q={class:"h-full overflow-auto min-h-[300px] md:min-h-0"},R=["onClick"],W={class:"flex items-center gap-2"},X={class:"flex flex-col"},Y={class:"text-sm font-bold text-neutral-800 dark:text-white"},Z={key:0,class:"text-sm font-light text-neutral-500"},ee={key:0},he={__name:"OwnerChat",props:{chats:{type:Object},messages:{type:[Object,null]},chat:{type:[Object,null]},apartment:{type:Object}},setup(C){const s=C,O=i=>{A.visit(route("account.apartments.owner.chat",{chat:i.id,apartment:i.apartment.id}))},l=z({message:""}),u=()=>{l.post(route("account.chat.messages.store",{chat:s.chat.data.id}),{preserveScroll:!0,onSuccess:()=>l.reset("message")})},j=D([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"apartments",route:route("account.apartments.list"),label:"Мои объекты"},{id:"chat",route:route("account.apartments.list"),label:"Чаты"}]);return(i,d)=>(t(),n(q,null,{default:c(()=>[o(V,null,{default:c(()=>{var _,p;return[o(U,{routes:j.value},null,8,["routes"]),o(B,{class:"mt-8",title:"Чат объекта"}),a("div",G,[a("div",H,[s.chat&&((p=(_=s.messages)==null?void 0:_.data)!=null&&p.length)?(t(),r("div",I,[(t(!0),r(w,null,k(s.messages.data,e=>(t(),n(E(e.reservation_request?b:S),{"is-owner":"",item:e.reservation_request?e.reservation_request:e,key:e.id},null,8,["item"]))),128))])):(t(),n(M,{key:1,title:s.chat?"Сообщений пока нет":"Выберите чат",subtitle:s.chat?"Напишите первым!":"И одобрите запрос на бронирование"},null,8,["title","subtitle"])),s.chat?(t(),r("div",J,[o(N,{modelValue:y(l).message,"onUpdate:modelValue":d[0]||(d[0]=e=>y(l).message=e),id:"message",label:"Сообщение",onOnEnter:u},null,8,["modelValue"]),o(T,{"auto-width":!0,onClick:u,class:"px-4",outline:!0,label:""},{icon:c(()=>[K]),_:1})])):m("",!0)]),a("div",P,[a("div",Q,[(t(!0),r(w,null,k(s.chats.data,e=>{var f,h,v,g,x;return t(),r("div",{key:e.id,onClick:te=>O(e),class:F(["gap-2 px-4 py-2 cursor-pointer flex flex-col w-full hover:bg-gray-100 dark:hover:bg-slate-600 transition",((f=s.chat)==null?void 0:f.data.id)===e.id?"bg-gray-100 dark:bg-slate-700":""])},[a("div",W,[o(L,{src:e.user.avatar},null,8,["src"]),a("div",X,[a("div",Y,$(e.user.name),1),(h=e.last_message)!=null&&h.reservation_request?m("",!0):(t(),r("div",Z,$((v=e.last_message)==null?void 0:v.message),1))])]),(g=e.last_message)!=null&&g.reservation_request?(t(),r("div",ee,[o(b,{compact:"",item:(x=e.last_message)==null?void 0:x.reservation_request},null,8,["item"])])):m("",!0)],10,R)}),128))])])])]}),_:1})]),_:1}))}};export{he as default};
