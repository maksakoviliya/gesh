import{c as q,b as R,f as U,_ as G}from"./AppLayout-d6cc72f2.js";import{_ as z}from"./Heading-474154c8.js";import{d as J,h as K,r as $,m as N,o as Q,j as C,w as u,a as h,e as m,g as e,t as s,c as M,f as L,u as V,i as k,v as W,b as X,F as Z,O as tt}from"./app-039abf0f.js";import{d as g}from"./ru-f8b56081.js";import{_ as et}from"./ButtonComponent-cb6eea3f.js";import{_ as st}from"./Breadcrumbs-0a7d8d17.js";import"./index.esm.min-a67645c7.js";import"./index-33f57259.js";import"./Input-b3b98bfb.js";import"./index-9ef572b0.js";import"./Avatar-886a66c6.js";import"./index-7a8f8af7.js";import"./useToasts-9554456c.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const w=1e3,S=60*w,E=60*S,j=24*E,H="abort",O="end",B="progress",A="start",F="visibilitychange";var at=J({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:i=>i>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:i=>i>=0},transform:{type:Function,default:i=>i}},emits:[H,O,B,A],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/j)},hours(){return Math.floor(this.totalMilliseconds%j/E)},minutes(){return Math.floor(this.totalMilliseconds%E/S)},seconds(){return Math.floor(this.totalMilliseconds%S/w)},milliseconds(){return Math.floor(this.totalMilliseconds%w)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/E)},totalMinutes(){return Math.floor(this.totalMilliseconds/S)},totalSeconds(){return Math.floor(this.totalMilliseconds/w)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(F,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(F,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(A),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const i=Math.min(this.totalMilliseconds,this.interval);if(i>0){let t,r;const p=l=>{t||(t=l),r||(r=l);const x=l-t;x>=i||x+(l-r)/2>=i?this.progress():this.requestId=requestAnimationFrame(p),r=l};this.requestId=requestAnimationFrame(p)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){this.counting&&(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(B,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){this.counting&&(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(H))},end(){this.counting&&(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(O))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return K(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const it={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},ot={class:"md:w-1/2 lg:w-2/3"},nt=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Ваша поездка: ",-1),rt={class:"mt-3"},lt=e("div",{class:"text-sm font-medium dark:text-slate-400"},"Даты:",-1),dt={class:"dark:text-slate-200 font-medium"},ct={class:"mt-3"},ut=e("div",{class:"text-sm font-medium dark:text-slate-400"},"Гости:",-1),ht={class:"dark:text-slate-200 font-medium"},mt={key:0,class:"font-medium dark:text-slate-200"},ft=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:text-slate-200 dark:border-slate-500"}," Оплата: ",-1),vt={class:"flex items-baseline gap-5"},_t=e("div",{class:"font-light text-sm text-neutral-800 leading-tight mt-4 dark:text-slate-400"},[k(" Сейчас вам необходимо оплатить только 30% от общей суммы, чтобы забронировать жилье. Оставшуюся сумму вы сможете перевести хозяину при заселении. "),e("br"),k("Таким образом, вы можете забронировать жилье заранее и не переживать о полной оплате до момента заселения. "),e("br"),k(" Оплата оставшейся суммы при заселении гарантирует вам получение жилья и удобство в расчетах. ")],-1),gt={class:"md:sticky w-full md:w-1/2 lg:w-1/3 rounded-lg shadow-lg border border-neutral-100 top-28 p-6"},pt={class:"flex items-stretch justify-start gap-4"},xt=["src"],yt={class:"flex flex-col justify-between"},bt={class:"text-gray-600 font-light dark:text-slate-300"},Mt=["innerHTML"],kt=e("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100 dark:border-slate-600 dark:text-slate-200"}," Детализация цены: ",-1),wt={class:"divide-y divide-gray-100 dark:divide-slate-600"},St={class:"py-2 flex w-full items-baseline justify-between"},Et=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Гости:")],-1),Dt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Tt={key:0,class:"py-2 flex w-full items-baseline justify-between"},$t=e("dt",{class:"font-light leading-6 text-gray-600 dark:text-slate-300"},[e("div",null,"Дети:")],-1),Nt={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Lt={class:"py-4 flex flex-col gap-2"},Yt={class:"flex w-full items-baseline justify-between"},It={class:"font-light leading-6 text-gray-600"},Ct={class:"font-light leading-none text-gray-600 dark:text-slate-300 outline-none border-b border-gray-400 dark:border-slate-300 hover:border-gray-600 transition"},Vt={class:"divide-y divide-gray-100 dark:divide-slate-600 max-h-52 overflow-auto"},jt={class:"font-light text-sm leading-6 text-gray-600 dark:text-slate-300"},Ht={class:"mt-1 text-sm font-medium leading-6 text-neutral-600 dark:text-slate-200"},Ot={class:"mt-1 font-medium leading-6 text-neutral-600 dark:text-slate-200"},Bt={class:"pt-4 flex w-full items-baseline justify-between"},At=e("dt",{class:"font-bold leading-6 text-neutral-800 dark:text-slate-200"},[e("div",null,"Итого:")],-1),Ft={class:"mt-1 font-bold leading-6 text-neutral-800 dark:text-slate-200"},ee={__name:"Payment",props:{reservation:{type:Object}},setup(i){var Y,I;const t=i,r=$([]);N(()=>{var v;g.extend(q);const a=g(t.reservation.data.start,"DD.MM.YYYY"),c=g(t.reservation.data.end,"DD.MM.YYYY");r.value=[];let f=0;for(let o=a;o.isBefore(c);o=o.add(1,"day")){const y=o.day()===5||o.day()===6?t.reservation.data.apartment.weekends_price:t.reservation.data.apartment.weekdays_price,_=((v=t.reservation.data.apartment.dates.find(b=>g(b.date).isSame(o)))==null?void 0:v.price)??y;r.value.push({date:o.format("DD.MM.YYYY"),price:_}),f+=_}return f});const p=N(()=>{let a=null;return(t.reservation.data.range<=1||t.reservation.data.range===21)&&(a=`${t.reservation.data.range} ночь`),(t.reservation.data.range>1&&t.reservation.data.range<=5||t.reservation.data.range>21&&t.reservation.data.range<=24)&&(a=`${t.reservation.data.range} ночи`),(t.reservation.data.range>5&&t.reservation.data.range<=20||t.reservation.data.range>24)&&(a=`${t.reservation.data.range} ночей`),`${a}`}),l=N(()=>[`${t.reservation.data.apartment.guests}&nbsp;гостей`,`${t.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${t.reservation.data.apartment.beds}&nbsp;кровать`,`${t.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(c=>!!c).join(" · ")),x=()=>{tt.visit(route("account.reservations.pay",{reservation:t.reservation.data.id}))},P=$([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:(Y=t.reservation.data)==null?void 0:Y.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(I=t.reservation.data)==null?void 0:I.id}),label:"Оплата"}]),D=$(0);return Q(()=>{const a=g(t.reservation.data.updated_at,"DD.MM.YYYY HH:mm").toDate(),c=new Date;a.setTime(a.getTime()+5*60*60*1e3),D.value=a.getTime()-c.getTime()}),(a,c)=>(h(),C(R,null,{default:u(()=>[m(G,null,{default:u(()=>{var f,v,o,y,T,_,b;return[m(st,{routes:P.value},null,8,["routes"]),e("div",it,[e("div",ot,[m(z,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее чем через пять часов, иначе бронирование отменится."}),e("div",null,[nt,e("div",rt,[lt,e("div",dt,s(t.reservation.data.start)+" - "+s(t.reservation.data.end),1)]),e("div",ct,[ut,e("div",ht,s(t.reservation.data.guests)+" гостя",1),t.reservation.data.children?(h(),M("div",mt,s(t.reservation.data.children)+" детей ",1)):L("",!0)])]),e("div",null,[ft,e("div",vt,[m(et,{class:"mt-3 px-16","auto-width":!0,label:`Перейти к оплате: ${(f=t.reservation.data.first_payment)==null?void 0:f.toLocaleString()}₽`,onClick:x},null,8,["label"]),D.value?(h(),C(V(at),{key:0,class:"text-neutral-800 dark:text-slate-400 font-medium text-lg",time:D.value},{default:u(({hours:n,minutes:d})=>[k(" Осталось "+s(n)+" ч. "+s(d)+" мин. ",1)]),_:1},8,["time"])):L("",!0)]),_t])]),e("div",gt,[e("div",pt,[m(V(W),{href:a.route("apartment",{apartment:(v=t.reservation.data.apartment)==null?void 0:v.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:u(()=>{var n,d;return[e("img",{src:(d=(n=t.reservation.data.apartment)==null?void 0:n.media[0])==null?void 0:d.src,class:"h-full w-full object-cover",alt:""},null,8,xt)]}),_:1},8,["href"]),e("div",yt,[e("div",bt,s((T=(y=(o=t.reservation.data)==null?void 0:o.apartment)==null?void 0:y.category)==null?void 0:T.title),1),e("div",{class:"font-light text-xs text-gray-600 mt-1 dark:text-slate-300",innerHTML:l.value},null,8,Mt)])]),kt,e("dl",wt,[e("div",St,[Et,e("dd",Dt,s(t.reservation.data.guests),1)]),t.reservation.data.children>0?(h(),M("div",Tt,[$t,e("dd",Nt,s(t.reservation.data.children),1)])):L("",!0),e("div",Lt,[e("div",Yt,[e("dt",It,[m(U,null,{toggle:u(()=>[e("div",Ct,s(p.value),1)]),content:u(()=>[e("dl",Vt,[(h(!0),M(Z,null,X(r.value,n=>{var d;return h(),M("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:n.date},[e("dt",jt,s(n.date),1),e("dd",Ht,s((d=n.price)==null?void 0:d.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),e("dd",Ot,s((_=t.reservation.data.price)==null?void 0:_.toLocaleString())+"₽ ",1)])]),e("div",Bt,[At,e("dd",Ft,s((b=t.reservation.data.price)==null?void 0:b.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{ee as default};
