import{d as h,c as V,e as C,g as Y,_ as F}from"./AppLayout-a0fb0f19.js";import{_ as O}from"./Heading-99e118e5.js";import{r as P,q as d,l as z,w as n,a as v,e as i,g as t,t as a,c as p,f as k,u as H,z as q,b as E,F as A,i as M,O as G}from"./app-b218c099.js";import{_ as I}from"./ButtonComponent-b8360dda.js";import{_ as J}from"./Breadcrumbs-a78499be.js";import"./index.esm.min-0dc835a5.js";import"./index-b33dc43e.js";import"./Input-43ca02ed.js";import"./Avatar-ad745d83.js";import"./useToasts-7e415cee.js";const K={class:"relative flex-col md:flex-row flex items-start gap-4 mt-6"},Q={class:"md:w-1/2 lg:w-2/3"},R=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Ваша поездка:",-1),U={class:"mt-3"},W=t("div",{class:"text-sm font-medium"},"Даты:",-1),X={class:"font-light"},Z={class:"mt-3"},tt=t("div",{class:"text-sm font-medium"},"Гости:",-1),et={class:"font-light"},at={key:0,class:"font-light"},st=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Оплата:",-1),ot=t("div",{class:"font-light text-sm text-neutral-800 leading-tight mt-2"}," Сейчас вам необходимо оплатить только 30% от общей суммы, чтобы забронировать жилье. Оставшуюся сумму вы сможете перевести хозяину при заселении в жилье. Таким образом, вы можете забронировать жилье заранее и не переживать о полной оплате до момента заселения. Оплата оставшейся суммы при заселении гарантирует вам получение жилья и удобство в расчетах. ",-1),rt={class:"md:sticky w-full md:w-1/2 lg:w-1/3 rounded-lg shadow-lg border border-neutral-100 top-28 p-6"},nt={class:"flex items-stretch justify-start gap-4"},it=["src"],lt={class:"flex flex-col justify-between"},dt={class:"text-gray-600 font-light"},ct=["innerHTML"],ut=t("div",{class:"font-semibold text-xl mt-4 pt-2 border-t border-gray-100"},"Детализация цены:",-1),_t={class:"divide-y divide-gray-100"},vt={class:"py-2 flex w-full items-baseline justify-between"},mt=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Гости:")],-1),ft={class:"mt-1 font-medium leading-6 text-neutral-600"},gt={key:0,class:"py-2 flex w-full items-baseline justify-between"},ht=t("dt",{class:"font-light leading-6 text-пкфн-600"},[t("div",null,"Дети:")],-1),pt={class:"mt-1 font-medium leading-6 text-neutral-600"},xt={class:"py-4 flex flex-col gap-2"},bt={class:"flex w-full items-baseline justify-between"},yt={class:"font-light leading-6 text-gray-600"},wt={class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},$t={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},jt={class:"font-light text-sm leading-6 text-gray-600"},Yt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},Pt={class:"mt-1 font-medium leading-6 text-neutral-600"},kt={class:"flex w-full items-baseline justify-between"},Mt={class:"font-light leading-6"},Dt=t("div",{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"}," Сервисный сбор ",-1),Lt=t("div",{class:"max-h-52 p-4 text-neutral-600 leading-tight text-sm"},[M(" Благодаря этому сбору мы развиваем наш сервис и, в том числе, обеспечиваем путешественников круглосуточной поддержкой. "),t("br"),M(" Данный сервисный сбор удерживатеся при отмене без уважительных причин. ")],-1),St={class:"mt-1 font-medium leading-6 text-neutral-600"},Bt={class:"pt-4 flex w-full items-baseline justify-between"},Tt=t("dt",{class:"font-bold leading-6 text-neutral-00"},[t("div",null,"Итого:")],-1),Nt={class:"mt-1 font-bold leading-6 text-neutral-800"},It={__name:"Payment",props:{reservation:{type:Object}},setup(D){var $,j;const e=D,x=P([]),m=d(()=>{var u;h.extend(V);const s=h(e.reservation.data.start,"DD.MM.YYYY"),f=h(e.reservation.data.end,"DD.MM.YYYY");x.value=[];let c=0;for(let o=s;o.isBefore(f);o=o.add(1,"day")){const g=o.day()===5||o.day()===6?e.reservation.data.apartment.weekends_price:e.reservation.data.apartment.weekdays_price,_=((u=e.reservation.data.apartment.dates.find(r=>h(r.date).isSame(o)))==null?void 0:u.price)??g;x.value.push({date:o.format("DD.MM.YYYY"),price:_}),c+=_}return c}),L=d(()=>{let s=null;return(e.reservation.data.range<=1||e.reservation.data.range===21)&&(s=`${e.reservation.data.range} ночь`),(e.reservation.data.range>1&&e.reservation.data.range<=5||e.reservation.data.range>21&&e.reservation.data.range<=24)&&(s=`${e.reservation.data.range} ночи`),(e.reservation.data.range>5&&e.reservation.data.range<=20||e.reservation.data.range>24)&&(s=`${e.reservation.data.range} ночей`),`${s}`}),S=d(()=>[`${e.reservation.data.apartment.guests}&nbsp;гостей`,`${e.reservation.data.apartment.bedrooms}&nbsp;спальня`,`${e.reservation.data.apartment.beds}&nbsp;кровать`,`${e.reservation.data.apartment.bathrooms}&nbsp;ванная`].filter(f=>!!f).join(" · ")),B=()=>{G.visit(route("account.reservations.pay",{reservation:e.reservation.data.id}))},T=P([{id:"account",route:route("account.index"),label:"Аккаунт"},{id:"reservations",route:route("account.reservations.list"),label:"Мои бронирования"},{id:"reservation",route:route("account.reservations.view",{reservation:($=e.reservation.data)==null?void 0:$.id}),label:"Бронирование"},{id:"reservation.pay",route:route("account.reservations.view",{reservation:(j=e.reservation.data)==null?void 0:j.id}),label:"Оплата"}]),y=d(()=>{const s=(m.value>=1e5,.15);return Math.ceil(m.value*s)}),w=d(()=>m.value+y.value),N=d(()=>Math.ceil(w.value*.3));return(s,f)=>(v(),z(C,null,{default:n(()=>[i(F,null,{default:n(()=>{var c,u,o,g,b,_;return[i(J,{routes:T.value},null,8,["routes"]),t("div",K,[t("div",Q,[i(O,{title:"Оплата бронирования",subtitle:"Вы должны оплатить не позднее суток, иначе бронирование отменится."}),t("div",null,[R,t("div",U,[W,t("div",X,a(e.reservation.data.start)+" - "+a(e.reservation.data.end),1)]),t("div",Z,[tt,t("div",et,a(e.reservation.data.guests)+" гостя",1),e.reservation.data.children?(v(),p("div",at,a(e.reservation.data.children)+" детей ",1)):k("",!0)])]),t("div",null,[st,i(I,{class:"mt-3 px-16","auto-width":!0,label:`Перейти к оплате: ${N.value.toLocaleString()}₽`,onClick:B},null,8,["label"]),ot])]),t("div",rt,[t("div",nt,[i(H(q),{href:s.route("apartment",{apartment:(c=e.reservation.data.apartment)==null?void 0:c.id}),class:"h-24 w-32 rounded-lg overflow-hidden"},{default:n(()=>{var r,l;return[t("img",{src:(l=(r=e.reservation.data.apartment)==null?void 0:r.media[0])==null?void 0:l.src,class:"h-full w-full object-cover",alt:""},null,8,it)]}),_:1},8,["href"]),t("div",lt,[t("div",dt,a((g=(o=(u=e.reservation.data)==null?void 0:u.apartment)==null?void 0:o.category)==null?void 0:g.title),1),t("div",{class:"font-light text-xs text-gray-600 mt-1",innerHTML:S.value},null,8,ct)])]),ut,t("dl",_t,[t("div",vt,[mt,t("dd",ft,a(e.reservation.data.guests),1)]),e.reservation.data.children>0?(v(),p("div",gt,[ht,t("dd",pt,a(e.reservation.data.children),1)])):k("",!0),t("div",xt,[t("div",bt,[t("dt",yt,[i(Y,null,{toggle:n(()=>[t("div",wt,a(L.value),1)]),content:n(()=>[t("dl",$t,[(v(!0),p(A,null,E(x.value,r=>{var l;return v(),p("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:r.date},[t("dt",jt,a(r.date),1),t("dd",Yt,a((l=r.price)==null?void 0:l.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",Pt,a((b=m.value)==null?void 0:b.toLocaleString())+"₽ ",1)]),t("div",kt,[t("dt",Mt,[i(Y,null,{toggle:n(()=>[Dt]),content:n(()=>[Lt]),_:1})]),t("dd",St,a((_=y.value)==null?void 0:_.toLocaleString())+"₽ ",1)])]),t("div",Bt,[Tt,t("dd",Nt,a(w.value.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{It as default};
