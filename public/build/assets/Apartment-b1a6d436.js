import{g as z,d as $,a as F,e as C,f as q,_ as H}from"./AppLayout-7893c9db.js";import{k as h,a as s,c as o,F as V,b as B,n as O,g as t,m as I,u as f,j as R,r as A,w as v,e as c,t as d,f as y,i as S}from"./app-851483fe.js";import{_ as G}from"./Heading-042823d9.js";import{_ as W}from"./ButtonComponent-81dcad43.js";import{_ as Z}from"./Avatar-7b2f2630.js";import{u as N}from"./useToasts-4fd246f6.js";import{_ as J}from"./Map.vue_vue_type_script_setup_true_lang-696d7a36.js";import"./index.esm.min-cd211803.js";import"./index-0f90dfca.js";import"./Input-76749a4b.js";const K={class:"rounded-xl grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 grid-rows-2 md:max-h-72 gap-1 overflow-hidden"},Q=["src"],X={__name:"Gallery",props:{images:{type:Array,default:[]}},setup(x){const e=x,i=h(()=>e.images.slice(0,4)),b=a=>{let _=[];return a===0&&_.push("row-span-2",i.value.length<=1?"col-span-full":"col-span-2"),a===1&&_.push(i.value.length<=3?"row-span-2":"",i.value.length<=2?"col-span-2":""),a===2&&_.push(i.value.length<=4?"row-span-2":"","row-span-2",i.value.length<=3?"col-span-1":""),_.join(" ")};return(a,_)=>(s(),o("div",K,[(s(!0),o(V,null,B(i.value,(w,g)=>(s(),o("div",{class:O(["group overflow-hidden",b(g)])},[t("img",{src:w.src,class:"object-cover w-full h-full transition cursor-pointer group-hover:scale-110",alt:""},null,8,Q)],2))),256))]))}};const tt={__name:"Datepicker",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},disabledDates:{type:Array,default:()=>[]}},emits:["setDates","invalidSelect"],setup(x,{emit:e}){const i=x,b=h(()=>[i.start,i.end]),a=e,_=p=>{a("setDates",{start:p[0],end:p[1]})},{errorToast:w}=N(),g=p=>{a("invalidSelect",p),w("Выбранный диапазон дат недоступен.")},k=h(()=>localStorage.getItem("color-theme")==="dark"||document.documentElement.classList.contains("dark"));return(p,M)=>(s(),I(f(z),{"model-value":b.value,"onUpdate:modelValue":_,"no-disabled-range":"","multi-calendars":"",dark:k.value,onInvalidSelect:g,"partial-range":!1,"auto-apply":"","month-change-on-scroll":!1,"max-range":"30","disabled-dates":i.disabledDates,"disable-year-select":"","month-name-format":"long",locale:"ru",format:"dd.MM.yyyy",placeholder:"Выберите даты","min-date":new Date,"enable-time-picker":!1,"hide-navigation":["month","year","time"]},null,8,["model-value","dark","disabled-dates","min-date"]))}},et={key:0,class:"text-3xl font-semibold"},at={class:"flex flex-col items-start lg:flex-row gap-6 justify-between mt-6 relative"},st={class:"w-full lg:w-2/3"},nt=t("hr",{class:"my-4"},null,-1),lt={class:"flex justify-between gap-x-6"},rt={class:"flex min-w-0 gap-x-4"},ot={class:"min-w-0 flex-auto"},dt={class:"text-sm font-semibold leading-6 text-gray-900"},it={class:"mt-1 truncate text-xs leading-5 text-gray-500"},ct=t("div",{class:"hidden shrink-0 sm:flex sm:flex-col sm:items-end"},[t("p",{class:"text-sm leading-6 text-gray-900"},"Владелец"),t("p",{class:"mt-1 text-xs leading-5 text-gray-500"},[S(" На сайте "),t("time",{datetime:"2023-01-23T13:23Z"},"2 года")])],-1),mt=t("hr",{class:"my-4"},null,-1),ut={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},_t=["innerHTML"],pt={class:"text-sm text-neutral-500"},gt={key:1,class:"mt-4 py-4 border-t"},ft={key:2,class:"mt-4 py-4 border-t"},ht={class:"relative lg:sticky rounded-lg shadow-lg border border-neutral-100 dark:border-slate-700 dark:shadow-gray-900 w-full lg:w-1/3 lg:top-28 p-6"},xt={class:"flex flex-wrap gap-2 xl:gap-4"},vt={class:"text-2xl md:text-3xl font-semibold flex items-center gap-2 dark:text-white"},yt={key:0,class:"flex flex-col"},bt=t("span",{class:"text-neutral-500 dark:text-slate-400 font-light text-sm leading-none whitespace-nowrap"},"ночь в",-1),wt=t("span",{class:"text-neutral-500 dark:text-slate-400 font-light text-sm leading-none"},"будни",-1),kt=[bt,wt],Dt={key:1},$t=t("span",{class:"text-neutral-500 dark:text-slate-400 font-light text-sm leading-none whitespace-nowrap"},"/ ночь",-1),St=[$t],jt={key:0,class:"text-2xl md:text-3xl font-semibold flex items-center gap-2"},Lt=t("div",{class:"flex flex-col"},[t("span",{class:"text-neutral-500 font-light text-sm leading-none whitespace-nowrap"},"ночь в"),t("span",{class:"text-neutral-500 font-light text-sm leading-none"},"выходные")],-1),Vt={class:"mt-4"},Tt={class:"flex flex-col gap-3 mt-4"},Bt=t("div",{class:"font-light text-sm text-center mt-3 text-neutral-500"},"Пока вы ни за что не платите",-1),Mt={class:"divide-y divide-gray-100 border-t mt-4"},Pt={class:"py-4 flex flex-col gap-2"},Ct={class:"flex w-full items-baseline justify-between"},qt={class:"font-light leading-6 text-gray-600"},At={class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"},It={class:"divide-y divide-gray-100 max-h-52 overflow-auto"},Nt={class:"font-light text-sm leading-6 text-gray-600"},Yt={class:"mt-1 text-sm font-medium leading-6 text-neutral-600"},Et={class:"mt-1 font-medium leading-6 text-neutral-600"},Ut={class:"flex w-full items-baseline justify-between"},zt={class:"font-light leading-6"},Ft=t("div",{class:"font-light leading-none text-gray-600 outline-none border-b border-gray-400 hover:border-gray-600 transition"}," Сервисный сбор ",-1),Ht=t("div",{class:"max-h-52 p-4 text-neutral-600 leading-tight text-sm"},[S(" Благодаря этому сбору мы развиваем наш сервис и, в том числе, обеспечиваем путешественников круглосуточной поддержкой. "),t("br"),S(" Данный сервисный сбор удерживатеся при отмене без уважительных причин. ")],-1),Ot={class:"mt-1 font-medium leading-6 text-neutral-600"},Rt={class:"border-t pt-4 flex flex-col gap-2"},Gt={class:"flex w-full items-baseline justify-between"},Wt=t("dt",{class:"font-bold leading-6 text-neutral-800"},"Итого:",-1),Zt={class:"mt-1 font-bold leading-6 text-lg text-neutral-800"},oe={__name:"Apartment",props:{apartment:Array|Object},setup(x){var P;const e=x,i=()=>{var l;return[(l=e.apartment.data.category)==null?void 0:l.title,e.apartment.data.title??null,e.apartment.data.city].filter(m=>!!m).join(", ")},b=()=>[`${e.apartment.data.guests} гостей`,`${e.apartment.data.bedrooms} спальня`,`${e.apartment.data.beds} кровать`,`${e.apartment.data.bathrooms} ванная`].filter(l=>!!l).join(" · "),a=R({start:new Date,end:new Date(new Date().setDate(new Date().getDate()+2)),range:2,guests:2,children:0}),_=h(()=>{let n=null;return(a.range<=1||a.range===21)&&(n=`${a.range} ночь`),(a.range>1&&a.range<=5||a.range>21&&a.range<=24)&&(n=`${a.range} ночи`),(a.range>5&&a.range<=20||a.range>24)&&(n=`${a.range} ночей`),`${n}`}),w=n=>{const l=$(n.start),m=$(n.end);a.start=l.set("hours",0).set("minutes",0).toDate(),a.end=m.set("hours",0).set("minutes",0).toDate(),a.range=m.diff(l,"day")},g=A([]),k=h(()=>{var D;const n=$(a.start),l=$(a.end);g.value=[];let m=0;for(let u=n;u.isBefore(l);u=u.add(1,"day")){const j=u.day()===5||u.day()===6?e.apartment.data.weekends_price:e.apartment.data.weekdays_price,r=((D=e.apartment.data.dates.find(L=>$(L.date).isSame(u)))==null?void 0:D.price)??j;g.value.push({date:u.format("DD.MM.YYYY"),price:r}),m+=r}return m}),p=h(()=>Math.ceil(k.value*.15)),M=h(()=>k.value+p.value),{errorToast:Y}=N(),E=()=>a.post(route("reservation-requests.store",{apartment:e.apartment.data.id}),{onError:n=>{Y(Object.values(n)[0])}}),U=A([{center:[e.apartment.data.lat,e.apartment.data.lon],img:(P=e.apartment.data.media[0])==null?void 0:P.src}]);return(n,l)=>(s(),I(F,null,{default:v(()=>[c(H,null,{default:v(()=>{var m,D,u,j,T;return[e.apartment.data.address?(s(),o("div",et,d(e.apartment.data.address),1)):y("",!0),c(X,{class:"mt-6",images:x.apartment.data.media},null,8,["images"]),t("div",at,[t("div",st,[c(G,{title:i(),subtitle:b()},null,8,["title","subtitle"]),nt,t("div",lt,[t("div",rt,[c(Z,{src:e.apartment.data.owner.avatar,class:"h-12 w-12 flex-none rounded-full bg-gray-50"},null,8,["src"]),t("div",ot,[t("p",dt," Хозяин: "+d(e.apartment.data.owner.name),1),t("p",it,d(e.apartment.data.owner.email),1)])]),ct]),e.apartment.data.features.length?(s(),o(V,{key:0},[mt,t("div",ut,[(s(!0),o(V,null,B(e.apartment.data.features,r=>(s(),o("div",{key:r.id,class:"flex items-center gap-3"},[t("div",{class:"text-neutral-800",innerHTML:r.icon},null,8,_t),t("div",pt,d(r.title),1)]))),128))])],64)):y("",!0),e.apartment.data.description?(s(),o("div",gt,d(e.apartment.data.description),1)):y("",!0),e.apartment.data.lon&&e.apartment.data.lat?(s(),o("div",ft,[c(J,{lon:e.apartment.data.lon,lat:e.apartment.data.lat,"is-input":!1,markers:U.value},null,8,["lon","lat","markers"])])):y("",!0)]),t("div",ht,[t("div",xt,[t("div",vt,[S(d((m=e.apartment.data.weekdays_price)==null?void 0:m.toLocaleString())+"₽ ",1),e.apartment.data.weekdays_price!==e.apartment.data.weekends_price?(s(),o("div",yt,kt)):(s(),o("div",Dt,St))]),e.apartment.data.weekdays_price!==e.apartment.data.weekends_price?(s(),o("div",jt,[S(d((D=e.apartment.data.weekends_price)==null?void 0:D.toLocaleString())+"₽ ",1),Lt])):y("",!0)]),t("div",Vt,[c(tt,{range:"",start:f(a).start,end:f(a).end,"disabled-dates":e.apartment.data.all_disabled_dates??[],onSetDates:w},null,8,["start","end","disabled-dates"]),c(C,{modelValue:f(a).guests,"onUpdate:modelValue":l[0]||(l[0]=r=>f(a).guests=r),class:"mt-4",title:"Гости",subtitle:"Укажите количество гостей"},null,8,["modelValue"]),c(C,{modelValue:f(a).children,"onUpdate:modelValue":l[1]||(l[1]=r=>f(a).children=r),class:"mt-4",title:"Дети",subtitle:"0-12 лет"},null,8,["modelValue"])]),t("div",Tt,[(e.apartment.data.fast_reserve,y("",!0)),c(W,{outline:!0,onClick:E,label:"Продолжить"})]),Bt,t("dl",Mt,[t("div",Pt,[t("div",Ct,[t("dt",qt,[c(q,null,{toggle:v(()=>[t("div",At,d(_.value),1)]),content:v(()=>[t("dl",It,[(s(!0),o(V,null,B(g.value,r=>{var L;return s(),o("div",{class:"py-1 px-4 flex w-full items-baseline justify-between",key:r.date},[t("dt",Nt,d(r.date),1),t("dd",Yt,d((L=r.price)==null?void 0:L.toLocaleString())+"₽ ",1)])}),128))])]),_:1})]),t("dd",Et,d((u=k.value)==null?void 0:u.toLocaleString())+"₽ ",1)]),t("div",Ut,[t("dt",zt,[c(q,null,{toggle:v(()=>[Ft]),content:v(()=>[Ht]),_:1})]),t("dd",Ot,d((j=p.value)==null?void 0:j.toLocaleString())+"₽ ",1)])])]),t("div",Rt,[t("div",Gt,[Wt,t("dd",Zt,d((T=M.value)==null?void 0:T.toLocaleString())+"₽ ",1)])])])])]}),_:1})]),_:1}))}};export{oe as default};
